package statechum.analysis.learning.experiments.PairSelection;

import java.io.IOException;
import java.util.Collection;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;
import java.util.Stack;
import java.util.TreeMap;
import java.util.Map.Entry;

import org.junit.Assert;
import org.junit.Test;

import statechum.Configuration;
import statechum.GlobalConfiguration;
import statechum.JUConstants;
import statechum.Label;
import statechum.Configuration.STATETREE;
import statechum.Configuration.ScoreMode;
import statechum.DeterministicDirectedSparseGraph.CmpVertex;
import statechum.GlobalConfiguration.G_PROPERTIES;
import statechum.analysis.learning.MarkovClassifier;
import statechum.analysis.learning.MarkovModel;
import statechum.analysis.learning.PairScore;
import statechum.analysis.learning.StatePair;
import statechum.analysis.learning.MarkovClassifier.ConsistencyChecker;
import statechum.analysis.learning.MarkovModel.MarkovOutcome;
import statechum.analysis.learning.experiments.MarkovEDSM.MarkovPassivePairSelection;
import statechum.analysis.learning.observers.ProgressDecorator.LearnerEvaluationConfiguration;
import statechum.analysis.learning.rpnicore.AbstractPersistence;
import statechum.analysis.learning.rpnicore.EquivalenceClass;
import statechum.analysis.learning.rpnicore.LearnerGraph;
import statechum.analysis.learning.rpnicore.LearnerGraphCachedData;
import statechum.analysis.learning.rpnicore.LearnerGraphND;
import statechum.analysis.learning.rpnicore.MergeStates;
import statechum.analysis.learning.rpnicore.Transform;
import statechum.analysis.learning.rpnicore.Transform.ConvertALabel;
import statechum.analysis.learning.rpnicore.WMethod.DifferentFSMException;
import statechum.analysis.learning.rpnicore.WMethod;
import statechum.collections.ArrayMapWithSearchPos;

public class TestLearnFromTracesUsingMarkov {
	static class InconsistencyComputation implements statechum.analysis.learning.rpnicore.PairScoreComputation.RedNodeSelectionProcedure
	{
		protected MarkovModel Markov;
		protected ConsistencyChecker checker;
		
		public InconsistencyComputation(MarkovModel model, ConsistencyChecker c)
		{
			Markov = model;checker = c;
		}
		
		@SuppressWarnings("unused")
		@Override
		public CmpVertex selectRedNode(LearnerGraph gr,Collection<CmpVertex> reds, Collection<CmpVertex> tentativeRedNodes) 
		{
			return tentativeRedNodes.iterator().next();
		}
		
		@SuppressWarnings("unused")
		@Override
		public CmpVertex resolvePotentialDeadEnd(LearnerGraph gr, Collection<CmpVertex> reds, List<PairScore> pairs) 
		{
			return null;												
		}
		
		long inconsistencyFromAnEarlierIteration = 0;
		LearnerGraph coregraph = null;
		LearnerGraph extendedGraph = null;
		MarkovClassifier cl=null;
		LearnerGraphND inverseGraph = null;
		long currentMillis = System.currentTimeMillis();
		Map<CmpVertex,Long> inconsistenciesPerVertex = null;
		
		@Override
		public void initComputation(LearnerGraph graph) 
		{
			coregraph = graph;
					 				
			long value = MarkovClassifier.computeInconsistency(coregraph, Markov, checker, false);
			inconsistencyFromAnEarlierIteration=value;
			cl = new MarkovClassifier(Markov, coregraph);
		    extendedGraph = cl.constructMarkovTentative();
			inverseGraph = (LearnerGraphND)MarkovClassifier.computeInverseGraph(coregraph,true);
			long newMillis = System.currentTimeMillis();
			inconsistenciesPerVertex = new ArrayMapWithSearchPos<CmpVertex,Long>(coregraph.getStateNumber());
//			for(CmpVertex v:coregraph.transitionMatrix.keySet())
//				inconsistenciesPerVertex.put(v,cl.checkFanoutInconsistency(v,checker,false));// cache the inconsistency of the original graph. This will be reused across numerous invocations of computeInconsistencyOfAMerger on the same original graph.
			System.out.println(""+(newMillis-currentMillis)/1000+" step, current inconsistency = "+value);
		}
		
		@Override
		public long overrideScoreComputation(PairScore p) 
		{
			if(p.getQ().isAccept()==false && p.getR().isAccept()==false)
				return 0;
			long score=p.getScore();						
			long currentInconsistency = 0;
			LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>> verticesToMerge = new LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>>();
			int genScore = coregraph.pairscores.computePairCompatibilityScore_general(p, null, verticesToMerge, false);
			if (genScore >= 0)
			{			
				LearnerGraph merged = MergeStates.mergeCollectionOfVertices(coregraph, null, verticesToMerge,false);
				/*
				{
					// Now test the "full" version of state merging routine.
					LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>> verticesToMergeFull = new LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>>();
					int fullScore = coregraph.pairscores.computePairCompatibilityScore_general(p, null, verticesToMergeFull, true);
					Assert.assertEquals(genScore, fullScore);
					LearnerGraph mergeFull = MergeStates.mergeCollectionOfVertices(coregraph, null, verticesToMergeFull,true);
					DifferentFSMException diffEx = WMethod.checkM(merged, mergeFull);
					if (diffEx != null)
						throw diffEx;
				}
				*/
				currentInconsistency = MarkovClassifier.computeInconsistency(merged, Markov, checker, false)-inconsistencyFromAnEarlierIteration;
				score=genScore-currentInconsistency;	

				long fastInconsistency =  MarkovClassifier.computeInconsistencyOfAMerger(coregraph, verticesToMerge, inconsistenciesPerVertex, merged, Markov, cl, checker);						
				Assert.assertEquals(currentInconsistency,fastInconsistency);
			}
			return score;
		}

		/** This one returns a set of transitions in all directions. */
		@Override
		public Collection<Entry<Label, CmpVertex>> getSurroundingTransitions(CmpVertex currentRed) 
		{
			return	MarkovPassivePairSelection.obtainSurroundingTransitions(coregraph,inverseGraph,currentRed);
		}
	}
	
	@Test
	public void testInconsistencyComputation() throws IOException {
		final int chunkLen = 3;

		Configuration config = Configuration.getDefaultConfiguration().copy();config.setAskQuestions(false);config.setDebugMode(false);config.setGdLowToHighRatio(0.7);config.setRandomPathAttemptFudgeThreshold(1000);
		config.setTransitionMatrixImplType(STATETREE.STATETREE_ARRAY);config.setLearnerScoreMode(ScoreMode.ONLYOVERRIDE);config.setAlwaysUseTheSameMatrixType(true);
		ConvertALabel converter = new Transform.InternStringLabel();
		GlobalConfiguration.getConfiguration().setProperty(G_PROPERTIES.LINEARWARNINGS, "false");
		
		
		LearnerGraph referenceGraph = null;
		String graphToTestComputationFrom = "resources/testInconsistencyComputation";
		/*
		final int traceQuantity=10;
		final double traceLengthMultiplier=1;
		final double alphabetMultiplier=2;
		final int minStateNumber = 30;
		final int states=minStateNumber;
		final int alphabet = (int)(alphabetMultiplier*states);
		final int seed = traceQuantity;
		MachineGenerator mg = new MachineGenerator(states, 400 , (int)Math.round((double)states/5));mg.setGenerateConnected(true);
		referenceGraph = mg.nextMachine(alphabet,seed, config, converter).pathroutines.buildDeterministicGraph();// reference graph has no reject-states, because we assume that undefined transitions lead to reject states.
		referenceGraph.storage.writeGraphML(graphToTestComputationFrom+".xml");
		*/
		referenceGraph = new LearnerGraph(config);AbstractPersistence.loadGraph(graphToTestComputationFrom+".xml",referenceGraph,converter);
		LearnerEvaluationConfiguration learnerEval = new LearnerEvaluationConfiguration(config);learnerEval.setLabelConverter(converter);
		//final Collection<List<Label>> testSet = PaperUAS.computeEvaluationSet(referenceGraph,states*3,PairQualityLearner.makeEven(states*alphabet*traceMultiplier));

		LearnerGraph pta = new LearnerGraph(config);AbstractPersistence.loadGraph(graphToTestComputationFrom+"_pta.xml",pta,converter);
		/*
		final int attempt=0;
		RandomPathGenerator generator = new RandomPathGenerator(referenceGraph,new Random(attempt),5,null);
		final int tracesToGenerate = PairQualityLearner.makeEven(traceQuantity);
		generator.generateRandomPosNeg(tracesToGenerate, 1, false, new RandomLengthGenerator() {
									
				@Override
				public int getLength() {
					return (int)(traceLengthMultiplier*states*alphabet);

				}

				@Override
				public int getPrefixLength(int len) {
					return len;
				}
			});

				pta.paths.augmentPTA(generator.getAllSequences(0).filter(new FilterPredicate() {
					@Override
					public boolean shouldBeReturned(Object name) {
						return ((statechum.analysis.learning.rpnicore.RandomPathGenerator.StateName)name).accept;
					}
				}));
	
			List<List<Label>> sPlus = generator.getAllSequences(0).getData(new FilterPredicate() {
				@Override
				public boolean shouldBeReturned(Object name) {
					return ((statechum.analysis.learning.rpnicore.RandomPathGenerator.StateName)name).accept;
				}
			});
			
		assert sPlus.size() > 0;
		*/
		//DifferentFSMException diff = WMethod.checkM(ptaExpected, ptaExpected.getInit(), pta, pta.getInit(), WMethod.VERTEX_COMPARISON_KIND.NONE);Assert.assertNull(diff);
		final MarkovModel m= new MarkovModel(chunkLen,true,true,true);

		new MarkovClassifier(m, pta).updateMarkov(false);
		pta.clearColours();

		assert pta.getStateNumber() == pta.getAcceptStateNumber() : "graph with negatives but onlyUsePositives is set";
			
		final Configuration deepCopy = pta.config.copy();deepCopy.setLearnerCloneGraph(true);
		LearnerGraph ptaCopy = new LearnerGraph(deepCopy);LearnerGraph.copyGraphs(pta, ptaCopy);

		final ConsistencyChecker checker = new MarkovClassifier.DifferentPredictionsInconsistencyNoBlacklistingIncludeMissingPrefixes();
		//long inconsistencyForTheReferenceGraph = MarkovClassifier.computeInconsistency(trimmedReference, m, checker,false);

		MarkovClassifier ptaClassifier = new MarkovClassifier(m,pta);
		final List<List<Label>> pathsToMerge=ptaClassifier.identifyPathsToMerge(checker);
		// These vertices are merged first and then the learning start from the root as normal.
		// The reason to learn from the root is a memory cost. if we learn from the middle, we can get a better results
		//final Collection<Set<CmpVertex>> verticesToMergeBasedOnInitialPTA=ptaClassifier.buildVerticesToMergeForPaths(pathsToMerge);

		
		List<StatePair> pairsListInitialMerge = ptaClassifier.buildVerticesToMergeForPath(pathsToMerge);
		LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>> verticesToMergeInitialMerge = new LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>>();
		int scoreInitialMerge = pta.pairscores.computePairCompatibilityScore_general(null, pairsListInitialMerge, verticesToMergeInitialMerge, false);
		assert scoreInitialMerge >= 0;
		final LearnerGraph ptaAfterInitialMerge = MergeStates.mergeCollectionOfVertices(pta, null, verticesToMergeInitialMerge,false);
		final CmpVertex vertexWithMostTransitions = MarkovPassivePairSelection.findVertexWithMostTransitions(ptaAfterInitialMerge,MarkovClassifier.computeInverseGraph(pta));
		ptaAfterInitialMerge.clearColours();ptaAfterInitialMerge.getInit().setColour(null);vertexWithMostTransitions.setColour(JUConstants.RED);
		ptaAfterInitialMerge.pathroutines.updateDepthLabelling();// this is needed in order for the .toString() to give the correct depth values in vertex details.
		ptaClassifier = new MarkovClassifier(m,ptaAfterInitialMerge);// rebuild the classifier
		LearnerGraphND inverseOfPtaAfterInitialMerge = MarkovClassifier.computeInverseGraph(ptaAfterInitialMerge);
		//System.out.println("Centre vertex: "+vertexWithMostTransitions+" "+MarkovPassivePairSelection.countTransitions(ptaAfterInitialMerge, inverseOfPtaAfterInitialMerge, vertexWithMostTransitions));
		
		// These have been recorded, there is no specific reason for the numbers to be as they are. We need them for regression testing.
		Assert.assertEquals(6438,vertexWithMostTransitions.getIntegerID());
		Assert.assertTrue(vertexWithMostTransitions.isAccept());
		Assert.assertEquals(26, MarkovPassivePairSelection.countTransitions(ptaAfterInitialMerge, inverseOfPtaAfterInitialMerge, vertexWithMostTransitions));
		
		// Check that Markov matrix is the right one
		Map<String,MarkovOutcome> map = new TreeMap<String,MarkovOutcome>();for(Entry<List<Label>, MarkovOutcome> entry:m.computePredictionMatrix().entrySet()) map.put(entry.getKey().toString(), entry.getValue()); 
		Assert.assertEquals("{[L1, L1, L17]=(+), [L1, L1, L28]=(+), [L1, L1, L49]=(+), [L1, L1, L53]=(+), [L1, L1, L56]=(+), [L1, L13, L21]=(+), [L1, L13, L2]=(+), [L1, L13, L59]=(+), [L1, L13]=(+), [L1, L17, L41]=(+), [L1, L17]=(+), [L1, L19, L45]=(+), [L1, L19, L55]=(+), [L1, L19]=(+), [L1, L1]=(+), [L1, L25, L13]=(+), [L1, L25, L19]=(+), [L1, L25, L25]=(+), [L1, L25]=(+), [L1, L28, L14]=(+), [L1, L28, L32]=(+), [L1, L28, L54]=(+), [L1, L28]=(+), [L1, L29, L23]=(+), [L1, L29, L45]=(+), [L1, L29]=(+), [L1, L49, L17]=(+), [L1, L49, L4]=(+), [L1, L49, L51]=(+), [L1, L49, L55]=(+), [L1, L49]=(+), [L1, L53, L13]=(+), [L1, L53, L21]=(+), [L1, L53, L23]=(+), [L1, L53, L3]=(+), [L1, L53, L40]=(+), [L1, L53, L44]=(+), [L1, L53, L45]=(+), [L1, L53, L50]=(+), [L1, L53, L51]=(+), [L1, L53, L54]=(+), [L1, L53]=(+), [L1, L56, L53]=(+), [L1, L56]=(+), [L11, L13, L2]=(+), [L11, L13, L49]=(+), [L11, L13, L59]=(+), [L11, L13]=(+), [L11, L21, L3]=(+), [L11, L21, L9]=(+), [L11, L21]=(+), [L11, L3, L17]=(+), [L11, L3, L4]=(+), [L11, L3, L51]=(+), [L11, L34, L4]=(+), [L11, L34]=(+), [L11, L3]=(+), [L11, L40, L19]=(+), [L11, L40, L37]=(+), [L11, L40]=(+), [L11, L44, L1]=(+), [L11, L44, L29]=(+), [L11, L44]=(+), [L11, L50, L53]=(+), [L11, L50]=(+), [L11, L51, L30]=(+), [L11, L51, L51]=(+), [L11, L51, L57]=(+), [L11, L51]=(+), [L11, L54, L41]=(+), [L11, L54]=(+), [L11]=(+), [L13, L1, L29]=(+), [L13, L13, L45]=(+), [L13, L13]=(+), [L13, L1]=(+), [L13, L2, L11]=(+), [L13, L2, L35]=(+), [L13, L2, L45]=(+), [L13, L21, L37]=(+), [L13, L21, L40]=(+), [L13, L21]=(+), [L13, L24, L53]=(+), [L13, L24]=(+), [L13, L2]=(+), [L13, L3, L28]=(+), [L13, L33, L53]=(+), [L13, L33]=(+), [L13, L3]=(+), [L13, L41, L40]=(+), [L13, L41, L54]=(+), [L13, L41]=(+), [L13, L44, L14]=(+), [L13, L44, L32]=(+), [L13, L44]=(+), [L13, L45, L53]=(+), [L13, L45]=(+), [L13, L49, L53]=(+), [L13, L49]=(+), [L13, L59, L1]=(+), [L13, L59, L29]=(+), [L13, L59]=(+), [L13, L9, L53]=(+), [L13, L9]=(+), [L13]=(+), [L14, L29, L21]=(+), [L14, L29, L2]=(+), [L14, L29, L49]=(+), [L14, L29, L59]=(+), [L14, L29]=(+), [L14, L39, L33]=(+), [L14, L39, L3]=(+), [L14, L39, L41]=(+), [L14, L39, L44]=(+), [L14, L39, L55]=(+), [L14, L39]=(+), [L14, L55, L17]=(+), [L14, L55, L28]=(+), [L14, L55, L49]=(+), [L14, L55, L53]=(+), [L14, L55, L56]=(+), [L14, L55]=(+), [L14, L59, L53]=(+), [L14, L59]=(+), [L14]=(+), [L16, L2, L13]=(+), [L16, L2, L21]=(+), [L16, L2, L34]=(+), [L16, L2, L3]=(+), [L16, L2, L40]=(+), [L16, L2, L44]=(+), [L16, L2, L50]=(+), [L16, L2, L51]=(+), [L16, L2, L54]=(+), [L16, L26, L53]=(+), [L16, L26]=(+), [L16, L27, L29]=(+), [L16, L27, L39]=(+), [L16, L27, L55]=(+), [L16, L27, L59]=(+), [L16, L27]=(+), [L16, L2]=(+), [L16, L35, L17]=(+), [L16, L35, L28]=(+), [L16, L35, L49]=(+), [L16, L35, L53]=(+), [L16, L35, L56]=(+), [L16, L35]=(+), [L16, L40, L33]=(+), [L16, L40, L3]=(+), [L16, L40, L41]=(+), [L16, L40, L44]=(+), [L16, L40, L47]=(+), [L16, L40, L55]=(+), [L16, L40]=(+), [L16, L44, L2]=(+), [L16, L44, L59]=(+), [L16, L44, L5]=(+), [L16, L44]=(+), [L16, L54, L13]=(+), [L16, L54, L1]=(+), [L16, L54, L24]=(+), [L16, L54, L45]=(+), [L16, L54, L9]=(+), [L16, L54]=(+), [L16]=(+), [L17, L3, L17]=(+), [L17, L3, L28]=(+), [L17, L33, L53]=(+), [L17, L33]=(+), [L17, L3]=(+), [L17, L41, L30]=(+), [L17, L41, L31]=(+), [L17, L41, L32]=(+), [L17, L41, L34]=(+), [L17, L41, L41]=(+), [L17, L41, L44]=(+), [L17, L41, L51]=(+), [L17, L41, L54]=(+), [L17, L41, L55]=(+), [L17, L41, L56]=(+), [L17, L41, L57]=(+), [L17, L41]=(+), [L17, L44, L32]=(+), [L17, L44, L54]=(+), [L17, L44]=(+), [L17, L45, L45]=(+), [L17, L45, L55]=(+), [L17, L45]=(+), [L17, L47, L21]=(+), [L17, L47, L2]=(+), [L17, L47, L49]=(+), [L17, L47, L59]=(+), [L17, L47]=(+), [L17, L55, L1]=(+), [L17, L55, L29]=(+), [L17, L55, L39]=(+), [L17, L55, L59]=(+), [L17, L55]=(+), [L17]=(+), [L19, L13, L21]=(+), [L19, L13, L2]=(+), [L19, L13, L49]=(+), [L19, L13]=(+), [L19, L19, L45]=(+), [L19, L19, L55]=(+), [L19, L19]=(+), [L19, L25, L13]=(+), [L19, L25, L19]=(+), [L19, L25, L25]=(+), [L19, L25]=(+), [L19, L45, L45]=(+), [L19, L45, L55]=(+), [L19, L45]=(+), [L19, L55, L29]=(+), [L19, L55, L39]=(+), [L19, L55, L55]=(+), [L19, L55, L59]=(+), [L19, L55]=(+), [L19]=(+), [L1]=(+), [L2, L11, L13]=(+), [L2, L11, L21]=(+), [L2, L11, L3]=(+), [L2, L11, L40]=(+), [L2, L11, L44]=(+), [L2, L11, L50]=(+), [L2, L11, L51]=(+), [L2, L11, L54]=(+), [L2, L11]=(+), [L2, L13, L21]=(+), [L2, L13, L49]=(+), [L2, L13, L59]=(+), [L2, L13]=(+), [L2, L21, L3]=(+), [L2, L21, L9]=(+), [L2, L21]=(+), [L2, L25, L26]=(+), [L2, L25, L27]=(+), [L2, L25, L2]=(+), [L2, L25, L35]=(+), [L2, L25, L40]=(+), [L2, L25, L44]=(+), [L2, L25, L54]=(+), [L2, L25]=(+), [L2, L3, L17]=(+), [L2, L3, L4]=(+), [L2, L3, L51]=(+), [L2, L3, L55]=(+), [L2, L34, L1]=(+), [L2, L34, L4]=(+), [L2, L34]=(+), [L2, L35, L11]=(+), [L2, L35, L35]=(+), [L2, L35, L45]=(+), [L2, L35]=(+), [L2, L3]=(+), [L2, L40, L19]=(+), [L2, L40, L37]=(+), [L2, L40]=(+), [L2, L44, L1]=(+), [L2, L44, L29]=(+), [L2, L44]=(+), [L2, L45, L33]=(+), [L2, L45, L3]=(+), [L2, L45, L41]=(+), [L2, L45, L44]=(+), [L2, L45, L47]=(+), [L2, L45, L55]=(+), [L2, L45]=(+), [L2, L50, L53]=(+), [L2, L50]=(+), [L2, L51, L41]=(+), [L2, L51, L51]=(+), [L2, L51, L54]=(+), [L2, L51, L56]=(+), [L2, L51]=(+), [L2, L54, L41]=(+), [L2, L54]=(+), [L21, L3, L1]=(+), [L21, L3, L24]=(+), [L21, L37, L13]=(+), [L21, L37, L19]=(+), [L21, L37, L25]=(+), [L21, L37]=(+), [L21, L3]=(+), [L21, L40, L45]=(+), [L21, L40, L55]=(+), [L21, L40]=(+), [L21, L9, L17]=(+), [L21, L9, L1]=(+), [L21, L9, L4]=(+), [L21, L9]=(+), [L21]=(+), [L23, L53, L23]=(+), [L23, L53, L45]=(+), [L23, L53]=(+), [L23]=(+), [L24, L2, L25]=(+), [L24, L2]=(+), [L24, L5, L8]=(+), [L24, L53, L23]=(+), [L24, L53, L45]=(+), [L24, L53]=(+), [L24, L59, L33]=(+), [L24, L59, L41]=(+), [L24, L59]=(+), [L24, L5]=(+), [L24]=(+), [L25, L13, L21]=(+), [L25, L13, L2]=(+), [L25, L13, L49]=(+), [L25, L13, L59]=(+), [L25, L13]=(+), [L25, L19, L45]=(+), [L25, L19, L55]=(+), [L25, L19]=(+), [L25, L2, L13]=(+), [L25, L2, L21]=(+), [L25, L2, L34]=(+), [L25, L2, L3]=(+), [L25, L2, L40]=(+), [L25, L2, L44]=(+), [L25, L2, L50]=(+), [L25, L2, L54]=(+), [L25, L25, L13]=(+), [L25, L25, L19]=(+), [L25, L25, L25]=(+), [L25, L25]=(+), [L25, L26, L53]=(+), [L25, L26]=(+), [L25, L27, L29]=(+), [L25, L27, L39]=(+), [L25, L27, L55]=(+), [L25, L27, L59]=(+), [L25, L27]=(+), [L25, L2]=(+), [L25, L35, L17]=(+), [L25, L35, L28]=(+), [L25, L35, L49]=(+), [L25, L35, L53]=(+), [L25, L35, L56]=(+), [L25, L35]=(+), [L25, L40, L33]=(+), [L25, L40, L3]=(+), [L25, L40, L41]=(+), [L25, L40, L44]=(+), [L25, L40, L47]=(+), [L25, L40, L55]=(+), [L25, L40]=(+), [L25, L44, L2]=(+), [L25, L44, L59]=(+), [L25, L44, L5]=(+), [L25, L44]=(+), [L25, L54, L13]=(+), [L25, L54, L1]=(+), [L25, L54, L24]=(+), [L25, L54, L45]=(+), [L25, L54, L9]=(+), [L25, L54]=(+), [L25]=(+), [L26, L53, L23]=(+), [L26, L53, L45]=(+), [L26, L53]=(+), [L26]=(+), [L27, L28, L28]=(+), [L27, L28, L8]=(+), [L27, L28]=(+), [L27, L29, L21]=(+), [L27, L29, L2]=(+), [L27, L29, L49]=(+), [L27, L29, L59]=(+), [L27, L29]=(+), [L27, L39, L33]=(+), [L27, L39, L3]=(+), [L27, L39, L41]=(+), [L27, L39, L44]=(+), [L27, L39, L47]=(+), [L27, L39, L55]=(+), [L27, L39]=(+), [L27, L55, L17]=(+), [L27, L55, L28]=(+), [L27, L55, L49]=(+), [L27, L55, L53]=(+), [L27, L55, L56]=(+), [L27, L55]=(+), [L27, L59, L53]=(+), [L27, L59]=(+), [L27, L8, L1]=(+), [L27, L8, L29]=(+), [L27, L8]=(+), [L27]=(+), [L28, L14, L29]=(+), [L28, L14, L39]=(+), [L28, L14, L55]=(+), [L28, L14, L59]=(+), [L28, L14]=(+), [L28, L28, L28]=(+), [L28, L28, L8]=(+), [L28, L28]=(+), [L28, L32, L30]=(+), [L28, L32, L31]=(+), [L28, L32, L32]=(+), [L28, L32, L34]=(+), [L28, L32, L41]=(+), [L28, L32, L51]=(+), [L28, L32, L54]=(+), [L28, L32, L55]=(+), [L28, L32, L56]=(+), [L28, L32, L57]=(+), [L28, L32]=(+), [L28, L54, L35]=(+), [L28, L54, L57]=(+), [L28, L54]=(+), [L28, L8, L1]=(+), [L28, L8, L29]=(+), [L28, L8]=(+), [L28]=(+), [L29, L2, L11]=(+), [L29, L2, L35]=(+), [L29, L2, L45]=(+), [L29, L21, L37]=(+), [L29, L21, L40]=(+), [L29, L21]=(+), [L29, L23, L53]=(+), [L29, L23]=(+), [L29, L2]=(+), [L29, L45, L8]=(+), [L29, L45]=(+), [L29, L49, L53]=(+), [L29, L49]=(+), [L29, L59, L1]=(+), [L29, L59, L29]=(+), [L29, L59]=(+), [L29]=(+), [L2]=(+), [L3, L1, L53]=(+), [L3, L17, L33]=(+), [L3, L17, L3]=(+), [L3, L17, L41]=(+), [L3, L17, L44]=(+), [L3, L17, L47]=(+), [L3, L17]=(+), [L3, L1]=(+), [L3, L24, L2]=(+), [L3, L24, L59]=(+), [L3, L24, L5]=(+), [L3, L24]=(+), [L3, L28, L14]=(+), [L3, L28, L32]=(+), [L3, L28, L54]=(+), [L3, L28]=(+), [L3, L4, L14]=(+), [L3, L4, L32]=(+), [L3, L4, L54]=(+), [L3, L49, L17]=(+), [L3, L49, L4]=(+), [L3, L49, L51]=(+), [L3, L49, L55]=(+), [L3, L49]=(+), [L3, L4]=(+), [L3, L51, L29]=(+), [L3, L51, L39]=(+), [L3, L51, L55]=(+), [L3, L51, L59]=(+), [L3, L51]=(+), [L3, L53, L21]=(+), [L3, L53, L34]=(+), [L3, L53, L3]=(+), [L3, L53, L44]=(+), [L3, L53, L50]=(+), [L3, L53, L51]=(+), [L3, L53]=(+), [L3, L55, L53]=(+), [L3, L55]=(+), [L3, L56, L53]=(+), [L3, L56]=(+), [L30, L3, L53]=(+), [L30, L33, L53]=(+), [L30, L33]=(+), [L30, L3]=(+), [L30, L41, L51]=(+), [L30, L41, L54]=(+), [L30, L41]=(+), [L30, L44, L14]=(+), [L30, L44, L32]=(+), [L30, L44, L54]=(+), [L30, L44]=(+), [L30, L47, L49]=(+), [L30, L47]=(+), [L30, L55, L1]=(+), [L30, L55, L29]=(+), [L30, L55]=(+), [L30]=(+), [L31, L17, L33]=(+), [L31, L17, L47]=(+), [L31, L17, L55]=(+), [L31, L17]=(+), [L31, L4, L14]=(+), [L31, L4, L32]=(+), [L31, L4, L54]=(+), [L31, L4]=(+), [L31, L51, L29]=(+), [L31, L51, L39]=(+), [L31, L51, L55]=(+), [L31, L51]=(+), [L31, L55, L53]=(+), [L31, L55]=(+), [L31]=(+), [L32, L1, L17]=(+), [L32, L1, L28]=(+), [L32, L1]=(+), [L32, L29, L23]=(+), [L32, L29, L45]=(+), [L32, L29]=(+), [L32, L30, L33]=(+), [L32, L30, L41]=(+), [L32, L30, L44]=(+), [L32, L30, L47]=(+), [L32, L30, L55]=(+), [L32, L30]=(+), [L32, L31, L17]=(+), [L32, L31, L4]=(+), [L32, L31, L51]=(+), [L32, L31, L55]=(+), [L32, L31]=(+), [L32, L32, L1]=(+), [L32, L32, L29]=(+), [L32, L32]=(+), [L32, L34, L2]=(+), [L32, L34, L59]=(+), [L32, L34]=(+), [L32, L41, L17]=(+), [L32, L41, L4]=(+), [L32, L41]=(+), [L32, L51, L3]=(+), [L32, L51, L9]=(+), [L32, L51]=(+), [L32, L54, L17]=(+), [L32, L54, L28]=(+), [L32, L54, L49]=(+), [L32, L54]=(+), [L32, L55, L29]=(+), [L32, L55, L39]=(+), [L32, L55, L59]=(+), [L32, L55]=(+), [L32, L56, L26]=(+), [L32, L56, L27]=(+), [L32, L56, L2]=(+), [L32, L56, L35]=(+), [L32, L56, L40]=(+), [L32, L56, L44]=(+), [L32, L56, L54]=(+), [L32, L56]=(+), [L32, L57, L13]=(+), [L32, L57, L52]=(+), [L32, L57]=(+), [L32]=(+), [L33, L53, L23]=(+), [L33, L53, L45]=(+), [L33, L53]=(+), [L33]=(+), [L34, L1, L13]=(+), [L34, L1, L19]=(+), [L34, L1, L25]=(+), [L34, L17, L45]=(+), [L34, L17, L55]=(+), [L34, L17]=(+), [L34, L1]=(+), [L34, L2, L11]=(+), [L34, L2, L35]=(+), [L34, L21, L37]=(+), [L34, L21, L40]=(+), [L34, L21]=(+), [L34, L2]=(+), [L34, L4, L21]=(+), [L34, L4, L2]=(+), [L34, L4, L49]=(+), [L34, L4, L59]=(+), [L34, L49, L53]=(+), [L34, L49]=(+), [L34, L4]=(+), [L34, L59, L1]=(+), [L34, L59, L29]=(+), [L34, L59]=(+), [L34]=(+), [L35, L11, L13]=(+), [L35, L11, L34]=(+), [L35, L11, L3]=(+), [L35, L11, L40]=(+), [L35, L11, L44]=(+), [L35, L11, L51]=(+), [L35, L11, L54]=(+), [L35, L11]=(+), [L35, L17, L41]=(+), [L35, L17]=(+), [L35, L28, L14]=(+), [L35, L28, L32]=(+), [L35, L28, L54]=(+), [L35, L28]=(+), [L35, L35, L11]=(+), [L35, L35, L35]=(+), [L35, L35, L45]=(+), [L35, L35]=(+), [L35, L45, L33]=(+), [L35, L45, L3]=(+), [L35, L45, L41]=(+), [L35, L45, L44]=(+), [L35, L45, L47]=(+), [L35, L45, L55]=(+), [L35, L45]=(+), [L35, L49, L17]=(+), [L35, L49, L4]=(+), [L35, L49, L51]=(+), [L35, L49, L55]=(+), [L35, L49]=(+), [L35, L53, L13]=(+), [L35, L53, L21]=(+), [L35, L53, L34]=(+), [L35, L53, L3]=(+), [L35, L53, L40]=(+), [L35, L53, L44]=(+), [L35, L53, L50]=(+), [L35, L53, L51]=(+), [L35, L53, L54]=(+), [L35, L53]=(+), [L35, L56, L53]=(+), [L35, L56]=(+), [L35, L8, L16]=(+), [L35, L8, L1]=(+), [L35, L8, L44]=(+), [L35, L8]=(+), [L35]=(+), [L37, L13, L21]=(+), [L37, L13, L2]=(+), [L37, L13, L49]=(+), [L37, L13, L59]=(+), [L37, L13]=(+), [L37, L19, L45]=(+), [L37, L19, L55]=(+), [L37, L19]=(+), [L37, L25, L13]=(+), [L37, L25, L19]=(+), [L37, L25, L25]=(+), [L37, L25]=(+), [L37, L52, L52]=(+), [L37, L52, L53]=(+), [L37, L52]=(+), [L37, L53, L2]=(+), [L37, L53, L59]=(+), [L37, L53, L5]=(+), [L37, L53]=(+), [L37]=(+), [L39, L3, L17]=(+), [L39, L3, L28]=(+), [L39, L3, L53]=(+), [L39, L3, L56]=(+), [L39, L33, L53]=(+), [L39, L33]=(+), [L39, L3]=(+), [L39, L41, L21]=(+), [L39, L41, L3]=(+), [L39, L41, L44]=(+), [L39, L41, L50]=(+), [L39, L41]=(+), [L39, L44, L14]=(+), [L39, L44, L32]=(+), [L39, L44, L54]=(+), [L39, L44]=(+), [L39, L47, L21]=(+), [L39, L47, L2]=(+), [L39, L47, L49]=(+), [L39, L47, L59]=(+), [L39, L47]=(+), [L39, L55, L1]=(+), [L39, L55, L29]=(+), [L39, L55]=(+), [L39]=(+), [L3]=(+), [L4, L14, L29]=(+), [L4, L14, L39]=(+), [L4, L14, L55]=(+), [L4, L14]=(+), [L4, L2, L11]=(+), [L4, L2, L35]=(+), [L4, L2, L45]=(+), [L4, L21, L37]=(+), [L4, L21, L40]=(+), [L4, L21]=(+), [L4, L2]=(+), [L4, L32, L32]=(+), [L4, L32, L41]=(+), [L4, L32, L51]=(+), [L4, L32, L55]=(+), [L4, L32, L56]=(+), [L4, L32, L57]=(+), [L4, L32]=(+), [L4, L49, L53]=(+), [L4, L49]=(+), [L4, L54, L35]=(+), [L4, L54, L57]=(+), [L4, L54]=(+), [L4, L59, L1]=(+), [L4, L59, L29]=(+), [L4, L59]=(+), [L40, L19, L13]=(+), [L40, L19, L19]=(+), [L40, L19, L25]=(+), [L40, L19]=(+), [L40, L3, L17]=(+), [L40, L3, L28]=(+), [L40, L3, L49]=(+), [L40, L3, L53]=(+), [L40, L3, L56]=(+), [L40, L33, L53]=(+), [L40, L33]=(+), [L40, L37, L52]=(+), [L40, L37, L53]=(+), [L40, L37]=(+), [L40, L3]=(+), [L40, L41, L21]=(+), [L40, L41, L34]=(+), [L40, L41, L3]=(+), [L40, L41, L40]=(+), [L40, L41, L44]=(+), [L40, L41, L51]=(+), [L40, L41, L54]=(+), [L40, L41]=(+), [L40, L44, L14]=(+), [L40, L44, L32]=(+), [L40, L44, L54]=(+), [L40, L44]=(+), [L40, L45, L45]=(+), [L40, L45, L55]=(+), [L40, L45]=(+), [L40, L47, L21]=(+), [L40, L47, L2]=(+), [L40, L47, L59]=(+), [L40, L47]=(+), [L40, L55, L1]=(+), [L40, L55, L29]=(+), [L40, L55, L39]=(+), [L40, L55, L55]=(+), [L40, L55, L59]=(+), [L40, L55]=(+), [L40]=(+), [L41, L1, L13]=(+), [L41, L1, L25]=(+), [L41, L13, L21]=(+), [L41, L13, L59]=(+), [L41, L13]=(+), [L41, L17, L45]=(+), [L41, L17, L55]=(+), [L41, L17]=(+), [L41, L1]=(+), [L41, L21, L3]=(+), [L41, L21, L9]=(+), [L41, L21]=(+), [L41, L3, L17]=(+), [L41, L3, L4]=(+), [L41, L3, L51]=(+), [L41, L3, L55]=(+), [L41, L30, L33]=(+), [L41, L30, L41]=(+), [L41, L30, L44]=(+), [L41, L30, L55]=(+), [L41, L30]=(+), [L41, L31, L17]=(+), [L41, L31, L4]=(+), [L41, L31, L51]=(+), [L41, L31, L55]=(+), [L41, L31]=(+), [L41, L32, L1]=(+), [L41, L32, L29]=(+), [L41, L32]=(+), [L41, L34, L17]=(+), [L41, L34, L1]=(+), [L41, L34, L21]=(+), [L41, L34, L2]=(+), [L41, L34, L49]=(+), [L41, L34, L4]=(+), [L41, L34, L59]=(+), [L41, L34]=(+), [L41, L3]=(+), [L41, L4, L21]=(+), [L41, L4, L2]=(+), [L41, L4, L49]=(+), [L41, L4, L59]=(+), [L41, L40, L19]=(+), [L41, L40, L37]=(+), [L41, L40]=(+), [L41, L41, L17]=(+), [L41, L41, L1]=(+), [L41, L41, L4]=(+), [L41, L41]=(+), [L41, L44, L1]=(+), [L41, L44, L29]=(+), [L41, L44]=(+), [L41, L4]=(+), [L41, L50, L53]=(+), [L41, L50]=(+), [L41, L51, L30]=(+), [L41, L51, L34]=(+), [L41, L51, L3]=(+), [L41, L51, L41]=(+), [L41, L51, L54]=(+), [L41, L51, L55]=(+), [L41, L51, L9]=(+), [L41, L51]=(+), [L41, L54, L28]=(+), [L41, L54, L41]=(+), [L41, L54, L49]=(+), [L41, L54, L56]=(+), [L41, L54]=(+), [L41, L55, L29]=(+), [L41, L55, L39]=(+), [L41, L55, L55]=(+), [L41, L55, L59]=(+), [L41, L55]=(+), [L41, L56, L27]=(+), [L41, L56, L35]=(+), [L41, L56, L54]=(+), [L41, L56]=(+), [L41, L57, L13]=(+), [L41, L57, L27]=(+), [L41, L57]=(+), [L41]=(+), [L44, L1, L28]=(+), [L44, L1, L49]=(+), [L44, L1, L53]=(+), [L44, L14, L29]=(+), [L44, L14, L39]=(+), [L44, L14, L55]=(+), [L44, L14, L59]=(+), [L44, L14]=(+), [L44, L1]=(+), [L44, L2, L25]=(+), [L44, L29, L23]=(+), [L44, L29, L45]=(+), [L44, L29]=(+), [L44, L2]=(+), [L44, L32, L30]=(+), [L44, L32, L31]=(+), [L44, L32, L32]=(+), [L44, L32, L34]=(+), [L44, L32, L41]=(+), [L44, L32, L51]=(+), [L44, L32, L54]=(+), [L44, L32, L56]=(+), [L44, L32, L57]=(+), [L44, L32]=(+), [L44, L5, L8]=(+), [L44, L54, L35]=(+), [L44, L54, L57]=(+), [L44, L54]=(+), [L44, L59, L33]=(+), [L44, L59, L3]=(+), [L44, L59, L41]=(+), [L44, L59, L44]=(+), [L44, L59, L47]=(+), [L44, L59, L55]=(+), [L44, L59]=(+), [L44, L5]=(+), [L44]=(+), [L45, L3, L17]=(+), [L45, L3, L49]=(+), [L45, L33, L53]=(+), [L45, L33]=(+), [L45, L3]=(+), [L45, L41, L13]=(+), [L45, L41, L34]=(+), [L45, L41, L3]=(+), [L45, L41, L50]=(+), [L45, L41, L51]=(+), [L45, L41]=(+), [L45, L44, L54]=(+), [L45, L44]=(+), [L45, L45, L45]=(+), [L45, L45, L55]=(+), [L45, L45]=(+), [L45, L47, L2]=(+), [L45, L47, L49]=(+), [L45, L47]=(+), [L45, L53, L23]=(+), [L45, L53, L45]=(+), [L45, L53]=(+), [L45, L55, L1]=(+), [L45, L55, L29]=(+), [L45, L55, L39]=(+), [L45, L55, L55]=(+), [L45, L55, L59]=(+), [L45, L55]=(+), [L45, L8, L16]=(+), [L45, L8, L1]=(+), [L45, L8, L44]=(+), [L45, L8]=(+), [L45]=(+), [L47, L2, L11]=(+), [L47, L2, L35]=(+), [L47, L2, L45]=(+), [L47, L21, L37]=(+), [L47, L21, L40]=(+), [L47, L21]=(+), [L47, L2]=(+), [L47, L49, L53]=(+), [L47, L49]=(+), [L47, L59, L1]=(+), [L47, L59, L29]=(+), [L47, L59]=(+), [L47]=(+), [L49, L17, L33]=(+), [L49, L17, L3]=(+), [L49, L17, L44]=(+), [L49, L17, L47]=(+), [L49, L17, L55]=(+), [L49, L17]=(+), [L49, L4, L14]=(+), [L49, L4, L32]=(+), [L49, L4, L54]=(+), [L49, L4]=(+), [L49, L51, L29]=(+), [L49, L51, L39]=(+), [L49, L51, L55]=(+), [L49, L51, L59]=(+), [L49, L51]=(+), [L49, L53, L23]=(+), [L49, L53, L45]=(+), [L49, L53]=(+), [L49, L55, L53]=(+), [L49, L55]=(+), [L49]=(+), [L4]=(+), [L5, L8, L16]=(+), [L5, L8, L1]=(+), [L5, L8, L44]=(+), [L5, L8]=(+), [L50, L53, L23]=(+), [L50, L53, L45]=(+), [L50, L53]=(+), [L50]=(+), [L51, L29, L21]=(+), [L51, L29, L2]=(+), [L51, L29, L49]=(+), [L51, L29, L59]=(+), [L51, L29]=(+), [L51, L3, L1]=(+), [L51, L3, L24]=(+), [L51, L30, L33]=(+), [L51, L30, L3]=(+), [L51, L30, L44]=(+), [L51, L30]=(+), [L51, L31, L4]=(+), [L51, L31]=(+), [L51, L32, L29]=(+), [L51, L32]=(+), [L51, L34, L2]=(+), [L51, L34]=(+), [L51, L39, L44]=(+), [L51, L39, L47]=(+), [L51, L39, L55]=(+), [L51, L39]=(+), [L51, L3]=(+), [L51, L41, L4]=(+), [L51, L41]=(+), [L51, L51, L3]=(+), [L51, L51, L9]=(+), [L51, L51]=(+), [L51, L54, L17]=(+), [L51, L54, L28]=(+), [L51, L54, L56]=(+), [L51, L54]=(+), [L51, L55, L17]=(+), [L51, L55, L28]=(+), [L51, L55, L29]=(+), [L51, L55, L49]=(+), [L51, L55, L53]=(+), [L51, L55, L56]=(+), [L51, L55, L59]=(+), [L51, L55]=(+), [L51, L56, L35]=(+), [L51, L56, L40]=(+), [L51, L56, L44]=(+), [L51, L56]=(+), [L51, L57, L13]=(+), [L51, L57]=(+), [L51, L59, L53]=(+), [L51, L59]=(+), [L51, L9, L17]=(+), [L51, L9, L1]=(+), [L51, L9, L4]=(+), [L51, L9]=(+), [L51]=(+), [L52, L51, L55]=(+), [L52, L51]=(+), [L52, L52, L52]=(+), [L52, L52, L53]=(+), [L52, L52]=(+), [L52, L53, L2]=(+), [L52, L53, L5]=(+), [L52, L53]=(+), [L52, L55, L53]=(+), [L52, L55]=(+), [L52]=(+), [L53, L13, L21]=(+), [L53, L13, L2]=(+), [L53, L13, L49]=(+), [L53, L13]=(+), [L53, L2, L25]=(+), [L53, L21, L3]=(+), [L53, L21, L9]=(+), [L53, L21]=(+), [L53, L23, L53]=(+), [L53, L23]=(+), [L53, L2]=(+), [L53, L3, L17]=(+), [L53, L3, L4]=(+), [L53, L3, L51]=(+), [L53, L3, L55]=(+), [L53, L34, L17]=(+), [L53, L34, L1]=(+), [L53, L34]=(+), [L53, L3]=(+), [L53, L40, L19]=(+), [L53, L40, L37]=(+), [L53, L40]=(+), [L53, L44, L1]=(+), [L53, L44, L29]=(+), [L53, L44]=(+), [L53, L45, L8]=(+), [L53, L45]=(+), [L53, L5, L8]=(+), [L53, L50, L53]=(+), [L53, L50]=(+), [L53, L51, L30]=(+), [L53, L51, L31]=(+), [L53, L51, L32]=(+), [L53, L51, L51]=(+), [L53, L51, L54]=(+), [L53, L51, L55]=(+), [L53, L51, L56]=(+), [L53, L51]=(+), [L53, L54, L41]=(+), [L53, L54]=(+), [L53, L59, L33]=(+), [L53, L59, L44]=(+), [L53, L59, L55]=(+), [L53, L59]=(+), [L53, L5]=(+), [L53]=(+), [L54, L1, L1]=(+), [L54, L1, L29]=(+), [L54, L13, L13]=(+), [L54, L13, L1]=(+), [L54, L13, L24]=(+), [L54, L13, L45]=(+), [L54, L13, L9]=(+), [L54, L13]=(+), [L54, L17, L41]=(+), [L54, L17]=(+), [L54, L1]=(+), [L54, L24, L53]=(+), [L54, L24]=(+), [L54, L28, L14]=(+), [L54, L28, L32]=(+), [L54, L28, L54]=(+), [L54, L28]=(+), [L54, L35, L8]=(+), [L54, L35]=(+), [L54, L41, L30]=(+), [L54, L41, L31]=(+), [L54, L41, L32]=(+), [L54, L41, L34]=(+), [L54, L41, L41]=(+), [L54, L41, L51]=(+), [L54, L41, L54]=(+), [L54, L41, L55]=(+), [L54, L41, L56]=(+), [L54, L41, L57]=(+), [L54, L41]=(+), [L54, L45, L53]=(+), [L54, L45]=(+), [L54, L49, L17]=(+), [L54, L49, L4]=(+), [L54, L49]=(+), [L54, L56, L53]=(+), [L54, L56]=(+), [L54, L57, L53]=(+), [L54, L57]=(+), [L54, L9, L53]=(+), [L54, L9]=(+), [L54]=(+), [L55, L1, L17]=(+), [L55, L1, L28]=(+), [L55, L1, L49]=(+), [L55, L1, L53]=(+), [L55, L1, L56]=(+), [L55, L17, L41]=(+), [L55, L17]=(+), [L55, L1]=(+), [L55, L28, L14]=(+), [L55, L28, L32]=(+), [L55, L28, L54]=(+), [L55, L28]=(+), [L55, L29, L21]=(+), [L55, L29, L23]=(+), [L55, L29, L2]=(+), [L55, L29, L45]=(+), [L55, L29, L49]=(+), [L55, L29, L59]=(+), [L55, L29]=(+), [L55, L39, L33]=(+), [L55, L39, L3]=(+), [L55, L39, L41]=(+), [L55, L39, L44]=(+), [L55, L39, L47]=(+), [L55, L39, L55]=(+), [L55, L39]=(+), [L55, L49, L17]=(+), [L55, L49, L4]=(+), [L55, L49, L51]=(+), [L55, L49, L55]=(+), [L55, L49]=(+), [L55, L53, L13]=(+), [L55, L53, L21]=(+), [L55, L53, L23]=(+), [L55, L53, L34]=(+), [L55, L53, L3]=(+), [L55, L53, L40]=(+), [L55, L53, L45]=(+), [L55, L53, L50]=(+), [L55, L53, L51]=(+), [L55, L53]=(+), [L55, L55, L17]=(+), [L55, L55, L28]=(+), [L55, L55, L49]=(+), [L55, L55, L53]=(+), [L55, L55, L56]=(+), [L55, L55]=(+), [L55, L56, L53]=(+), [L55, L56]=(+), [L55, L59, L53]=(+), [L55, L59]=(+), [L55]=(+), [L56, L2, L13]=(+), [L56, L2, L21]=(+), [L56, L2, L3]=(+), [L56, L26, L53]=(+), [L56, L26]=(+), [L56, L27, L29]=(+), [L56, L27, L39]=(+), [L56, L27, L59]=(+), [L56, L27]=(+), [L56, L2]=(+), [L56, L35, L28]=(+), [L56, L35, L49]=(+), [L56, L35, L53]=(+), [L56, L35]=(+), [L56, L40, L44]=(+), [L56, L40, L55]=(+), [L56, L40]=(+), [L56, L44, L2]=(+), [L56, L44, L59]=(+), [L56, L44]=(+), [L56, L53, L23]=(+), [L56, L53, L45]=(+), [L56, L53]=(+), [L56, L54, L13]=(+), [L56, L54, L1]=(+), [L56, L54, L24]=(+), [L56, L54, L45]=(+), [L56, L54]=(+), [L56]=(+), [L57, L13, L33]=(+), [L57, L13, L3]=(+), [L57, L13, L41]=(+), [L57, L13, L44]=(+), [L57, L13]=(+), [L57, L27, L28]=(+), [L57, L27, L8]=(+), [L57, L27]=(+), [L57, L52, L51]=(+), [L57, L52, L55]=(+), [L57, L52]=(+), [L57, L53, L23]=(+), [L57, L53, L45]=(+), [L57, L53]=(+), [L57]=(+), [L59, L1, L17]=(+), [L59, L1, L28]=(+), [L59, L1, L49]=(+), [L59, L1, L53]=(+), [L59, L1]=(+), [L59, L29, L23]=(+), [L59, L29, L45]=(+), [L59, L29]=(+), [L59, L3, L17]=(+), [L59, L3, L28]=(+), [L59, L3, L49]=(+), [L59, L3, L53]=(+), [L59, L3, L56]=(+), [L59, L33, L53]=(+), [L59, L33]=(+), [L59, L3]=(+), [L59, L41, L13]=(+), [L59, L41, L21]=(+), [L59, L41, L34]=(+), [L59, L41, L3]=(+), [L59, L41, L40]=(+), [L59, L41, L44]=(+), [L59, L41, L50]=(+), [L59, L41, L51]=(+), [L59, L41, L54]=(+), [L59, L41]=(+), [L59, L44, L14]=(+), [L59, L44, L32]=(+), [L59, L44, L54]=(+), [L59, L44]=(+), [L59, L47, L21]=(+), [L59, L47, L2]=(+), [L59, L47, L49]=(+), [L59, L47, L59]=(+), [L59, L47]=(+), [L59, L53, L23]=(+), [L59, L53, L45]=(+), [L59, L53]=(+), [L59, L55, L1]=(+), [L59, L55, L29]=(+), [L59, L55]=(+), [L59]=(+), [L5]=(+), [L8, L1, L17]=(+), [L8, L1, L53]=(+), [L8, L16, L26]=(+), [L8, L16, L27]=(+), [L8, L16, L2]=(+), [L8, L16, L35]=(+), [L8, L16, L40]=(+), [L8, L16, L44]=(+), [L8, L16, L54]=(+), [L8, L16]=(+), [L8, L1]=(+), [L8, L29, L23]=(+), [L8, L29, L45]=(+), [L8, L29]=(+), [L8, L44, L2]=(+), [L8, L44, L59]=(+), [L8, L44, L5]=(+), [L8, L44]=(+), [L8]=(+), [L9, L1, L13]=(+), [L9, L1, L19]=(+), [L9, L1, L25]=(+), [L9, L17, L55]=(+), [L9, L17]=(+), [L9, L1]=(+), [L9, L4, L2]=(+), [L9, L4, L49]=(+), [L9, L4, L59]=(+), [L9, L4]=(+), [L9, L53, L23]=(+), [L9, L53, L45]=(+), [L9, L53]=(+), [L9]=(+)}",
				map.toString());
		//ptaAfterInitialMerge.storage.writeGraphML(graphToTestComputationFrom+"_afterinitialmerge.xml");
		LearnerGraph expectedAfterInitialMerge = new LearnerGraph(config);AbstractPersistence.loadGraph(graphToTestComputationFrom+"_afterinitialmerge.xml", expectedAfterInitialMerge,converter);
		DifferentFSMException diff = WMethod.checkM(expectedAfterInitialMerge, ptaAfterInitialMerge);// checks that the graph is as expected.
		Assert.assertNull(diff);
		long value = MarkovClassifier.computeInconsistency(ptaAfterInitialMerge, m, checker, false);
		Assert.assertEquals(29,value);// check that we computed inconsistencies in the usual way.

		Stack<PairScore> stack = ptaAfterInitialMerge.pairscores.chooseStatePairs(new InconsistencyComputation(m, checker));
		Assert.assertEquals("[[ P1584(true,13), P1436(true,12) : 0,0 ], [ P2539(true,28), P4673(true,11) : 0,0 ], [ P2593(true,30), P4673(true,11) : 0,0 ], [ P2987(true,14), P1312(true,13) : 0,0 ], [ P3147(true,15), P1010(true,8) : 0,0 ], [ P3147(true,15), P4673(true,11) : 0,0 ], [ P3161(true,13), P6441(true,13) : 0,0 ], [ P3325(true,14), P1585(true,14) : 0,0 ], [ P3346(true,13), P4673(true,11) : 0,0 ], [ P4297(true,12), P4673(true,11) : 0,0 ], [ P4406(true,18), P4673(true,11) : 0,0 ], [ P4656(true,13), P4673(true,11) : 0,0 ], [ P4656(true,13), P4673(true,11) : 0,0 ], [ P6459(true,11), P1149(true,12) : 0,0 ], [ P7918(true,13), P1954(true,15) : 0,0 ], [ P8460(true,13), P3160(true,12) : 0,0 ], [ P8580(true,19), P4673(true,11) : 0,0 ], [ P9982(true,13), P7520(true,13) : 0,0 ], [ P1005(true,5), P6499(true,11) : 1,1 ], [ P1007(true,7), P6499(true,11) : 1,1 ], [ P1007(true,7), P6499(true,11) : 1,1 ], [ P1011(true,9), P6499(true,11) : 1,1 ], [ P1011(true,9), P6499(true,11) : 1,1 ], [ P1018(true,10), P1009(true,7) : 1,1 ], [ P1036(true,25), P6499(true,11) : 1,1 ], [ P1053(true,20), P1009(true,7) : 1,1 ], [ P1059(true,13), P1009(true,7) : 1,1 ], [ P1067(true,15), P1009(true,7) : 1,1 ], [ P1087(true,27), P1009(true,7) : 1,1 ], [ P1113(true,11), P6499(true,11) : 1,1 ], [ P1136(true,18), P1009(true,7) : 1,1 ], [ P1180(true,40), P1009(true,7) : 1,1 ], [ P1196(true,23), P6499(true,11) : 1,1 ], [ P1227(true,22), P6499(true,11) : 1,1 ], [ P1243(true,12), P4673(true,11) : 1,1 ], [ P1274(true,43), P1009(true,7) : 1,1 ], [ P1296(true,13), P6499(true,11) : 1,1 ], [ P1336(true,37), P6499(true,11) : 1,1 ], [ P1346(true,13), P6499(true,11) : 1,1 ], [ P1362(true,21), P4673(true,11) : 1,1 ], [ P1389(true,18), P6499(true,11) : 1,1 ], [ P1419(true,30), P6499(true,11) : 1,1 ], [ P1459(true,23), P1149(true,12) : 1,1 ], [ P1488(true,21), P1009(true,7) : 1,1 ], [ P1546(true,44), P1009(true,7) : 1,1 ], [ P1574(true,16), P6499(true,11) : 1,1 ], [ P1597(true,15), P6499(true,11) : 1,1 ], [ P1654(true,32), P6499(true,11) : 1,1 ], [ P1680(true,23), P1436(true,12) : 1,1 ], [ P1714(true,16), P1009(true,7) : 1,1 ], [ P1743(true,36), P6499(true,11) : 1,1 ], [ P1759(true,15), P6499(true,11) : 1,1 ], [ P1824(true,22), P1585(true,14) : 1,1 ], [ P1878(true,22), P1009(true,7) : 1,1 ], [ P1906(true,19), P1009(true,7) : 1,1 ], [ P1942(true,22), P6499(true,11) : 1,1 ], [ P1985(true,20), P4673(true,11) : 1,1 ], [ P2002(true,14), P6499(true,11) : 1,1 ], [ P2042(true,26), P6499(true,11) : 1,1 ], [ P2069(true,26), P6499(true,11) : 1,1 ], [ P2118(true,22), P1009(true,7) : 1,1 ], [ P2126(true,15), P6499(true,11) : 1,1 ], [ P2149(true,15), P6499(true,11) : 1,1 ], [ P2185(true,16), P6499(true,11) : 1,1 ], [ P2222(true,18), P1009(true,7) : 1,1 ], [ P2236(true,15), P6499(true,11) : 1,1 ], [ P2273(true,23), P1009(true,7) : 1,1 ], [ P2283(true,17), P1009(true,7) : 1,1 ], [ P2292(true,16), P6499(true,11) : 1,1 ], [ P2311(true,22), P6499(true,11) : 1,1 ], [ P2393(true,28), P1009(true,7) : 1,1 ], [ P2418(true,32), P1009(true,7) : 1,1 ], [ P2443(true,32), P1009(true,7) : 1,1 ], [ P2448(true,12), P6499(true,11) : 1,1 ], [ P2505(true,22), P6499(true,11) : 1,1 ], [ P2622(true,18), P1009(true,7) : 1,1 ], [ P2660(true,26), P6499(true,11) : 1,1 ], [ P2678(true,21), P1009(true,7) : 1,1 ], [ P2760(true,34), P6499(true,11) : 1,1 ], [ P2794(true,33), P1009(true,7) : 1,1 ], [ P2811(true,11), P6499(true,11) : 1,1 ], [ P2848(true,21), P1009(true,7) : 1,1 ], [ P2863(true,22), P1009(true,7) : 1,1 ], [ P2870(true,14), P4673(true,11) : 1,1 ], [ P2919(true,33), P6499(true,11) : 1,1 ], [ P2954(true,22), P6499(true,11) : 1,1 ], [ P3009(true,36), P6499(true,11) : 1,1 ], [ P3064(true,28), P1009(true,7) : 1,1 ], [ P3075(true,12), P6499(true,11) : 1,1 ], [ P3121(true,15), P1009(true,7) : 1,1 ], [ P3127(true,13), P6499(true,11) : 1,1 ], [ P3155(true,23), P1009(true,7) : 1,1 ], [ P3181(true,33), P6499(true,11) : 1,1 ], [ P3190(true,12), P6499(true,11) : 1,1 ], [ P3190(true,12), P6499(true,11) : 1,1 ], [ P3213(true,24), P1009(true,7) : 1,1 ], [ P3217(true,11), P6499(true,11) : 1,1 ], [ P3228(true,16), P6499(true,11) : 1,1 ], [ P3253(true,11), P6499(true,11) : 1,1 ], [ P3281(true,29), P6499(true,11) : 1,1 ], [ P3294(true,13), P6499(true,11) : 1,1 ], [ P3325(true,14), P1312(true,13) : 1,1 ], [ P3336(true,25), P6499(true,11) : 1,1 ], [ P3360(true,13), P1585(true,14) : 1,1 ], [ P3360(true,13), P6441(true,13) : 1,1 ], [ P3396(true,14), P6499(true,11) : 1,1 ], [ P3513(true,15), P4673(true,11) : 1,1 ], [ P3600(true,22), P1009(true,7) : 1,1 ], [ P3615(true,22), P6499(true,11) : 1,1 ], [ P3627(true,15), P6499(true,11) : 1,1 ], [ P3660(true,21), P1009(true,7) : 1,1 ], [ P3677(true,17), P6499(true,11) : 1,1 ], [ P3702(true,26), P6499(true,11) : 1,1 ], [ P3785(true,42), P6499(true,11) : 1,1 ], [ P3805(true,23), P6499(true,11) : 1,1 ], [ P3849(true,29), P6499(true,11) : 1,1 ], [ P3897(true,18), P6499(true,11) : 1,1 ], [ P3954(true,23), P6499(true,11) : 1,1 ], [ P4072(true,18), P6499(true,11) : 1,1 ], [ P4101(true,24), P1009(true,7) : 1,1 ], [ P4113(true,19), P1009(true,7) : 1,1 ], [ P4133(true,16), P1009(true,7) : 1,1 ], [ P4203(true,16), P6499(true,11) : 1,1 ], [ P4235(true,29), P6499(true,11) : 1,1 ], [ P4253(true,18), P6499(true,11) : 1,1 ], [ P4269(true,15), P6499(true,11) : 1,1 ], [ P4328(true,19), P1009(true,7) : 1,1 ], [ P4351(true,13), P6499(true,11) : 1,1 ], [ P4395(true,18), P1009(true,7) : 1,1 ], [ P4449(true,18), P6499(true,11) : 1,1 ], [ P4500(true,30), P6499(true,11) : 1,1 ], [ P4548(true,43), P6499(true,11) : 1,1 ], [ P4596(true,18), P6499(true,11) : 1,1 ], [ P4640(true,40), P6499(true,11) : 1,1 ], [ P4667(true,10), P6499(true,11) : 1,1 ], [ P4694(true,14), P6499(true,11) : 1,1 ], [ P4706(true,15), P1009(true,7) : 1,1 ], [ P4711(true,12), P6499(true,11) : 1,1 ], [ P4732(true,20), P6499(true,11) : 1,1 ], [ P4749(true,12), P6499(true,11) : 1,1 ], [ P4773(true,15), P4673(true,11) : 1,1 ], [ P4801(true,31), P1009(true,7) : 1,1 ], [ P4828(true,34), P6499(true,11) : 1,1 ], [ P4844(true,17), P6499(true,11) : 1,1 ], [ P4856(true,13), P6499(true,11) : 1,1 ], [ P4884(true,23), P6499(true,11) : 1,1 ], [ P4958(true,19), P6499(true,11) : 1,1 ], [ P4986(true,17), P6499(true,11) : 1,1 ], [ P5016(true,33), P4673(true,11) : 1,1 ], [ P5071(true,16), P6499(true,11) : 1,1 ], [ P5084(true,16), P1009(true,7) : 1,1 ], [ P5143(true,17), P4673(true,11) : 1,1 ], [ P5162(true,13), P6499(true,11) : 1,1 ], [ P5188(true,31), P1009(true,7) : 1,1 ], [ P5272(true,28), P1009(true,7) : 1,1 ], [ P5314(true,41), P4673(true,11) : 1,1 ], [ P5380(true,13), P3324(true,13) : 1,1 ], [ P5391(true,24), P6499(true,11) : 1,1 ], [ P5424(true,20), P6499(true,11) : 1,1 ], [ P5440(true,19), P6499(true,11) : 1,1 ], [ P5449(true,12), P6499(true,11) : 1,1 ], [ P5481(true,31), P6499(true,11) : 1,1 ], [ P5506(true,23), P1009(true,7) : 1,1 ], [ P5517(true,18), P6499(true,11) : 1,1 ], [ P5536(true,22), P6499(true,11) : 1,1 ], [ P5633(true,13), P4673(true,11) : 1,1 ], [ P5686(true,18), P6499(true,11) : 1,1 ], [ P5773(true,23), P1009(true,7) : 1,1 ], [ P5798(true,32), P6499(true,11) : 1,1 ], [ P5825(true,30), P6499(true,11) : 1,1 ], [ P5870(true,23), P6499(true,11) : 1,1 ], [ P5910(true,15), P1009(true,7) : 1,1 ], [ P5946(true,13), P1149(true,12) : 1,1 ], [ P6012(true,15), P6499(true,11) : 1,1 ], [ P6033(true,16), P1009(true,7) : 1,1 ], [ P6061(true,35), P1009(true,7) : 1,1 ], [ P6069(true,15), P6499(true,11) : 1,1 ], [ P6106(true,23), P4673(true,11) : 1,1 ], [ P6132(true,19), P1009(true,7) : 1,1 ], [ P6158(true,21), P6499(true,11) : 1,1 ], [ P6190(true,22), P1585(true,14) : 1,1 ], [ P6236(true,18), P6499(true,11) : 1,1 ], [ P6256(true,16), P6499(true,11) : 1,1 ], [ P6379(true,14), P4673(true,11) : 1,1 ], [ P6398(true,15), P6499(true,11) : 1,1 ], [ P6407(true,7), P6499(true,11) : 1,1 ], [ P6415(true,9), P1955(true,16) : 1,1 ], [ P6415(true,9), P1955(true,16) : 1,1 ], [ P6417(true,11), P6499(true,11) : 1,1 ], [ P6429(true,11), P1955(true,16) : 1,1 ], [ P6431(true,13), P6499(true,11) : 1,1 ], [ P6442(true,14), P7297(true,12) : 1,1 ], [ P6455(true,27), P1009(true,7) : 1,1 ], [ P6460(true,12), P6499(true,11) : 1,1 ], [ P6492(true,21), P1009(true,7) : 1,1 ], [ P6497(true,12), P1149(true,12) : 1,1 ], [ P6517(true,11), P6499(true,11) : 1,1 ], [ P6543(true,15), P6499(true,11) : 1,1 ], [ P6589(true,35), P1009(true,7) : 1,1 ], [ P6599(true,17), P6499(true,11) : 1,1 ], [ P6613(true,11), P6499(true,11) : 1,1 ], [ P6620(true,12), P6499(true,11) : 1,1 ], [ P6633(true,12), P6499(true,11) : 1,1 ], [ P6633(true,12), P6499(true,11) : 1,1 ], [ P6666(true,36), P6499(true,11) : 1,1 ], [ P6682(true,13), P6499(true,11) : 1,1 ], [ P6703(true,26), P6499(true,11) : 1,1 ], [ P6755(true,23), P6499(true,11) : 1,1 ], [ P6768(true,16), P6499(true,11) : 1,1 ], [ P6789(true,21), P1009(true,7) : 1,1 ], [ P6807(true,25), P6499(true,11) : 1,1 ], [ P6841(true,27), P6499(true,11) : 1,1 ], [ P6862(true,16), P6499(true,11) : 1,1 ], [ P6911(true,29), P1009(true,7) : 1,1 ], [ P6948(true,15), P1009(true,7) : 1,1 ], [ P6968(true,27), P1009(true,7) : 1,1 ], [ P7028(true,32), P6499(true,11) : 1,1 ], [ P7047(true,16), P6499(true,11) : 1,1 ], [ P7064(true,13), P8459(true,12) : 1,1 ], [ P7072(true,21), P1009(true,7) : 1,1 ], [ P7109(true,26), P6499(true,11) : 1,1 ], [ P7130(true,13), P4673(true,11) : 1,1 ], [ P7165(true,34), P1009(true,7) : 1,1 ], [ P7171(true,13), P6499(true,11) : 1,1 ], [ P7185(true,15), P1009(true,7) : 1,1 ], [ P7213(true,25), P6499(true,11) : 1,1 ], [ P7263(true,32), P6499(true,11) : 1,1 ], [ P7299(true,14), P6499(true,11) : 1,1 ], [ P7339(true,28), P1009(true,7) : 1,1 ], [ P7356(true,24), P6499(true,11) : 1,1 ], [ P7379(true,22), P4673(true,11) : 1,1 ], [ P7411(true,15), P4673(true,11) : 1,1 ], [ P7438(true,20), P6499(true,11) : 1,1 ], [ P7480(true,13), P1149(true,12) : 1,1 ], [ P7480(true,13), P1149(true,12) : 1,1 ], [ P7514(true,29), P1009(true,7) : 1,1 ], [ P7523(true,16), P6499(true,11) : 1,1 ], [ P7523(true,16), P6499(true,11) : 1,1 ], [ P7546(true,12), P4673(true,11) : 1,1 ], [ P7546(true,12), P4673(true,11) : 1,1 ], [ P7559(true,16), P1009(true,7) : 1,1 ], [ P7594(true,21), P1009(true,7) : 1,1 ], [ P7605(true,18), P6499(true,11) : 1,1 ], [ P7667(true,16), P1009(true,7) : 1,1 ], [ P7693(true,33), P6499(true,11) : 1,1 ], [ P7708(true,15), P1009(true,7) : 1,1 ], [ P7724(true,19), P6499(true,11) : 1,1 ], [ P7738(true,14), P6499(true,11) : 1,1 ], [ P7750(true,12), P6499(true,11) : 1,1 ], [ P7787(true,16), P6499(true,11) : 1,1 ], [ P7825(true,35), P1009(true,7) : 1,1 ], [ P7867(true,12), P4673(true,11) : 1,1 ], [ P7897(true,33), P6499(true,11) : 1,1 ], [ P7928(true,23), P6499(true,11) : 1,1 ], [ P7947(true,19), P6499(true,11) : 1,1 ], [ P8000(true,29), P1009(true,7) : 1,1 ], [ P8036(true,16), P1009(true,7) : 1,1 ], [ P8046(true,17), P6499(true,11) : 1,1 ], [ P8121(true,17), P6499(true,11) : 1,1 ], [ P8155(true,21), P1585(true,14) : 1,1 ], [ P8197(true,14), P6499(true,11) : 1,1 ], [ P8213(true,13), P6499(true,11) : 1,1 ], [ P8231(true,11), P1009(true,7) : 1,1 ], [ P8248(true,19), P6499(true,11) : 1,1 ], [ P8279(true,12), P6499(true,11) : 1,1 ], [ P8287(true,13), P1009(true,7) : 1,1 ], [ P8297(true,11), P6499(true,11) : 1,1 ], [ P8388(true,57), P6499(true,11) : 1,1 ], [ P8440(true,21), P1009(true,7) : 1,1 ], [ P8469(true,22), P1009(true,7) : 1,1 ], [ P8483(true,14), P1009(true,7) : 1,1 ], [ P8497(true,13), P6499(true,11) : 1,1 ], [ P8536(true,42), P1009(true,7) : 1,1 ], [ P8541(true,12), P4673(true,11) : 1,1 ], [ P8611(true,16), P6499(true,11) : 1,1 ], [ P8619(true,13), P6499(true,11) : 1,1 ], [ P8685(true,20), P6499(true,11) : 1,1 ], [ P8721(true,30), P6499(true,11) : 1,1 ], [ P8755(true,26), P6499(true,11) : 1,1 ], [ P8781(true,19), P1436(true,12) : 1,1 ], [ P8804(true,19), P6499(true,11) : 1,1 ], [ P8820(true,13), P6499(true,11) : 1,1 ], [ P8882(true,29), P1009(true,7) : 1,1 ], [ P8924(true,23), P6499(true,11) : 1,1 ], [ P8936(true,13), P6499(true,11) : 1,1 ], [ P8957(true,14), P6499(true,11) : 1,1 ], [ P8988(true,18), P1009(true,7) : 1,1 ], [ P9010(true,29), P4673(true,11) : 1,1 ], [ P9028(true,21), P6499(true,11) : 1,1 ], [ P9060(true,35), P1009(true,7) : 1,1 ], [ P9100(true,25), P6499(true,11) : 1,1 ], [ P9129(true,28), P6499(true,11) : 1,1 ], [ P9175(true,20), P6499(true,11) : 1,1 ], [ P9196(true,24), P6499(true,11) : 1,1 ], [ P9219(true,26), P6499(true,11) : 1,1 ], [ P9296(true,64), P6499(true,11) : 1,1 ], [ P9360(true,23), P4673(true,11) : 1,1 ], [ P9391(true,13), P6499(true,11) : 1,1 ], [ P9426(true,38), P1009(true,7) : 1,1 ], [ P9435(true,16), P1009(true,7) : 1,1 ], [ P9452(true,24), P1009(true,7) : 1,1 ], [ P9468(true,23), P6499(true,11) : 1,1 ], [ P9488(true,21), P1009(true,7) : 1,1 ], [ P9497(true,16), P6499(true,11) : 1,1 ], [ P9527(true,17), P6499(true,11) : 1,1 ], [ P9580(true,26), P6499(true,11) : 1,1 ], [ P9596(true,19), P1009(true,7) : 1,1 ], [ P9669(true,19), P6499(true,11) : 1,1 ], [ P9702(true,32), P4673(true,11) : 1,1 ], [ P9736(true,31), P1009(true,7) : 1,1 ], [ P9765(true,16), P1009(true,7) : 1,1 ], [ P9784(true,26), P6499(true,11) : 1,1 ], [ P9853(true,34), P6499(true,11) : 1,1 ], [ P9876(true,22), P6499(true,11) : 1,1 ], [ P9911(true,13), P4673(true,11) : 1,1 ], [ P9944(true,16), P1009(true,7) : 1,1 ], [ P9966(true,22), P6499(true,11) : 1,1 ], [ P9982(true,13), P3160(true,12) : 1,1 ], [ P9988(true,19), P6499(true,11) : 1,1 ], [ P1313(true,14), P3160(true,12) : 2,2 ], [ P2320(true,12), P4673(true,11) : 2,2 ], [ P3161(true,13), P7297(true,12) : 2,2 ], [ P3361(true,14), P4673(true,11) : 2,2 ], [ P4805(true,11), P4673(true,11) : 2,2 ], [ P5809(true,14), P1954(true,15) : 2,2 ], [ P6569(true,15), P6568(true,14) : 2,2 ], [ P7298(true,13), P3189(true,11) : 2,2 ], [ P1065(true,13), P6499(true,11) : 3,3 ], [ P1901(true,14), P3324(true,13) : 3,3 ], [ P5433(true,12), P4673(true,11) : 3,3 ], [ P6415(true,9), P1010(true,8) : 3,3 ], [ P6415(true,9), P1010(true,8) : 3,3 ], [ P6415(true,9), P1311(true,12) : 3,3 ], [ P6415(true,9), P1311(true,12) : 3,3 ], [ P6595(true,13), P6632(true,11) : 3,3 ], [ P7918(true,13), P6440(true,12) : 3,3 ], [ P7984(true,13), P3324(true,13) : 3,3 ], [ P1073(true,13), P3189(true,11) : 4,4 ], [ P2854(true,13), P6440(true,12) : 4,4 ], [ P4998(true,15), P4673(true,11) : 4,4 ], [ P7599(true,12), P4673(true,11) : 4,4 ], [ P8241(true,12), P6440(true,12) : 4,4 ], [ P8416(true,12), P4673(true,11) : 4,4 ], [ P4995(true,12), P8240(true,11) : 5,5 ], [ P8415(true,11), P3189(true,11) : 5,5 ], [ P1153(true,13), P1152(true,12) : 6,6 ], [ P8607(true,12), P1149(true,12) : 6,6 ], [ P2496(true,13), P1149(true,12) : 7,7 ], [ P8259(true,11), P4673(true,11) : 7,7 ], [ P6029(true,12), P8240(true,11) : 10,10 ], [ P2945(true,13), P1063(true,11) : 12,12 ], [ P3590(true,12), P3189(true,11) : 12,12 ], [ P2616(true,12), P1063(true,11) : 13,13 ], [ P6429(true,11), P1010(true,8) : 15,15 ], [ P1017(true,9), P3324(true,13) : 29,29 ]]",
				stack.toString());
		LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>> verticesToMerge = new LinkedList<EquivalenceClass<CmpVertex,LearnerGraphCachedData>>();
		int genScore = ptaAfterInitialMerge.pairscores.computePairCompatibilityScore_general(stack.peek(), null, verticesToMerge, false);
		Assert.assertTrue(genScore >= 0);
		LearnerGraph merged = MergeStates.mergeCollectionOfVertices(ptaAfterInitialMerge, null, verticesToMerge,false);
		merged.pathroutines.updateDepthLabelling();// this is needed in order for the .toString() to give the correct depth values in vertex details.
		stack = merged.pairscores.chooseStatePairs(new InconsistencyComputation(m, checker));
		//Assert.assertEquals("[[ P1584(true,13), P1436(true,12) : 0,0 ], [ P2539(true,28), P4673(true,11) : 0,0 ], [ P2593(true,30), P4673(true,11) : 0,0 ], [ P2987(true,14), P1312(true,13) : 0,0 ], [ P3147(true,15), P1010(true,8) : 0,0 ], [ P3147(true,15), P4673(true,11) : 0,0 ], [ P3161(true,13), P6441(true,13) : 0,0 ], [ P3346(true,13), P4673(true,11) : 0,0 ], [ P4297(true,12), P4673(true,11) : 0,0 ], [ P4406(true,18), P4673(true,11) : 0,0 ], [ P4656(true,13), P4673(true,11) : 0,0 ], [ P4656(true,13), P4673(true,11) : 0,0 ], [ P6459(true,11), P1149(true,12) : 0,0 ], [ P7918(true,13), P1954(true,15) : 0,0 ], [ P8460(true,13), P3160(true,12) : 0,0 ], [ P8580(true,19), P4673(true,11) : 0,0 ], [ P9982(true,13), P7520(true,13) : 0,0 ], [ P1005(true,5), P6499(true,11) : 1,1 ], [ P1007(true,7), P6499(true,11) : 1,1 ], [ P1007(true,7), P6499(true,11) : 1,1 ], [ P1011(true,9), P6499(true,11) : 1,1 ], [ P1011(true,9), P6499(true,11) : 1,1 ], [ P1018(true,10), P1009(true,7) : 1,1 ], [ P1018(true,10), P1009(true,7) : 1,1 ], [ P1036(true,25), P6499(true,11) : 1,1 ], [ P1053(true,20), P1009(true,7) : 1,1 ], [ P1059(true,13), P1009(true,7) : 1,1 ], [ P1067(true,15), P1009(true,7) : 1,1 ], [ P1087(true,27), P1009(true,7) : 1,1 ], [ P1113(true,11), P6499(true,11) : 1,1 ], [ P1136(true,18), P1009(true,7) : 1,1 ], [ P1180(true,40), P1009(true,7) : 1,1 ], [ P1196(true,23), P6499(true,11) : 1,1 ], [ P1227(true,22), P6499(true,11) : 1,1 ], [ P1243(true,12), P4673(true,11) : 1,1 ], [ P1274(true,43), P1009(true,7) : 1,1 ], [ P1296(true,13), P6499(true,11) : 1,1 ], [ P1336(true,37), P6499(true,11) : 1,1 ], [ P1346(true,13), P6499(true,11) : 1,1 ], [ P1362(true,21), P4673(true,11) : 1,1 ], [ P1389(true,18), P6499(true,11) : 1,1 ], [ P1419(true,30), P6499(true,11) : 1,1 ], [ P1459(true,23), P1149(true,12) : 1,1 ], [ P1488(true,21), P1009(true,7) : 1,1 ], [ P1546(true,44), P1009(true,7) : 1,1 ], [ P1574(true,16), P6499(true,11) : 1,1 ], [ P1597(true,15), P6499(true,11) : 1,1 ], [ P1654(true,32), P6499(true,11) : 1,1 ], [ P1680(true,23), P1436(true,12) : 1,1 ], [ P1714(true,16), P1009(true,7) : 1,1 ], [ P1743(true,36), P6499(true,11) : 1,1 ], [ P1759(true,15), P6499(true,11) : 1,1 ], [ P1824(true,22), P1585(true,14) : 1,1 ], [ P1878(true,22), P1009(true,7) : 1,1 ], [ P1906(true,19), P1009(true,7) : 1,1 ], [ P1942(true,22), P6499(true,11) : 1,1 ], [ P1985(true,20), P4673(true,11) : 1,1 ], [ P2002(true,14), P6499(true,11) : 1,1 ], [ P2042(true,26), P6499(true,11) : 1,1 ], [ P2069(true,26), P6499(true,11) : 1,1 ], [ P2118(true,22), P1009(true,7) : 1,1 ], [ P2126(true,15), P6499(true,11) : 1,1 ], [ P2149(true,15), P6499(true,11) : 1,1 ], [ P2185(true,16), P6499(true,11) : 1,1 ], [ P2222(true,18), P1009(true,7) : 1,1 ], [ P2236(true,15), P6499(true,11) : 1,1 ], [ P2273(true,23), P1009(true,7) : 1,1 ], [ P2283(true,17), P1009(true,7) : 1,1 ], [ P2292(true,16), P6499(true,11) : 1,1 ], [ P2311(true,22), P6499(true,11) : 1,1 ], [ P2393(true,28), P1009(true,7) : 1,1 ], [ P2418(true,32), P1009(true,7) : 1,1 ], [ P2443(true,32), P1009(true,7) : 1,1 ], [ P2448(true,12), P6499(true,11) : 1,1 ], [ P2505(true,22), P6499(true,11) : 1,1 ], [ P2622(true,18), P1009(true,7) : 1,1 ], [ P2660(true,26), P6499(true,11) : 1,1 ], [ P2678(true,21), P1009(true,7) : 1,1 ], [ P2760(true,34), P6499(true,11) : 1,1 ], [ P2794(true,33), P1009(true,7) : 1,1 ], [ P2811(true,11), P6499(true,11) : 1,1 ], [ P2848(true,21), P1009(true,7) : 1,1 ], [ P2863(true,22), P1009(true,7) : 1,1 ], [ P2870(true,14), P4673(true,11) : 1,1 ], [ P2919(true,33), P6499(true,11) : 1,1 ], [ P2954(true,22), P6499(true,11) : 1,1 ], [ P3009(true,36), P6499(true,11) : 1,1 ], [ P3064(true,28), P1009(true,7) : 1,1 ], [ P3075(true,12), P6499(true,11) : 1,1 ], [ P3121(true,15), P1009(true,7) : 1,1 ], [ P3127(true,13), P6499(true,11) : 1,1 ], [ P3155(true,23), P1009(true,7) : 1,1 ], [ P3181(true,33), P6499(true,11) : 1,1 ], [ P3190(true,12), P6499(true,11) : 1,1 ], [ P3190(true,12), P6499(true,11) : 1,1 ], [ P3213(true,24), P1009(true,7) : 1,1 ], [ P3217(true,11), P6499(true,11) : 1,1 ], [ P3228(true,16), P6499(true,11) : 1,1 ], [ P3253(true,11), P6499(true,11) : 1,1 ], [ P3281(true,29), P6499(true,11) : 1,1 ], [ P3294(true,13), P6499(true,11) : 1,1 ], [ P3336(true,21), P6499(true,11) : 1,1 ], [ P3360(true,13), P1585(true,14) : 1,1 ], [ P3360(true,13), P6441(true,13) : 1,1 ], [ P3396(true,14), P6499(true,11) : 1,1 ], [ P3513(true,15), P4673(true,11) : 1,1 ], [ P3600(true,22), P1009(true,7) : 1,1 ], [ P3615(true,22), P6499(true,11) : 1,1 ], [ P3627(true,15), P6499(true,11) : 1,1 ], [ P3660(true,21), P1009(true,7) : 1,1 ], [ P3702(true,26), P6499(true,11) : 1,1 ], [ P3785(true,42), P6499(true,11) : 1,1 ], [ P3805(true,23), P6499(true,11) : 1,1 ], [ P3849(true,29), P6499(true,11) : 1,1 ], [ P3897(true,18), P6499(true,11) : 1,1 ], [ P3954(true,23), P6499(true,11) : 1,1 ], [ P4072(true,18), P6499(true,11) : 1,1 ], [ P4101(true,24), P1009(true,7) : 1,1 ], [ P4113(true,19), P1009(true,7) : 1,1 ], [ P4133(true,16), P1009(true,7) : 1,1 ], [ P4203(true,16), P6499(true,11) : 1,1 ], [ P4235(true,29), P6499(true,11) : 1,1 ], [ P4253(true,18), P6499(true,11) : 1,1 ], [ P4269(true,15), P6499(true,11) : 1,1 ], [ P4328(true,19), P1009(true,7) : 1,1 ], [ P4351(true,13), P6499(true,11) : 1,1 ], [ P4395(true,18), P1009(true,7) : 1,1 ], [ P4449(true,18), P6499(true,11) : 1,1 ], [ P4500(true,30), P6499(true,11) : 1,1 ], [ P4548(true,43), P6499(true,11) : 1,1 ], [ P4596(true,18), P6499(true,11) : 1,1 ], [ P4640(true,40), P6499(true,11) : 1,1 ], [ P4667(true,10), P6499(true,11) : 1,1 ], [ P4694(true,14), P6499(true,11) : 1,1 ], [ P4706(true,15), P1009(true,7) : 1,1 ], [ P4711(true,12), P6499(true,11) : 1,1 ], [ P4732(true,20), P6499(true,11) : 1,1 ], [ P4749(true,12), P6499(true,11) : 1,1 ], [ P4773(true,15), P4673(true,11) : 1,1 ], [ P4801(true,31), P1009(true,7) : 1,1 ], [ P4828(true,34), P6499(true,11) : 1,1 ], [ P4844(true,17), P6499(true,11) : 1,1 ], [ P4856(true,13), P6499(true,11) : 1,1 ], [ P4884(true,23), P6499(true,11) : 1,1 ], [ P4958(true,19), P6499(true,11) : 1,1 ], [ P4982(true,13), P6499(true,11) : 1,1 ], [ P5016(true,33), P4673(true,11) : 1,1 ], [ P5071(true,16), P6499(true,11) : 1,1 ], [ P5084(true,16), P1009(true,7) : 1,1 ], [ P5143(true,17), P4673(true,11) : 1,1 ], [ P5162(true,13), P6499(true,11) : 1,1 ], [ P5188(true,31), P1009(true,7) : 1,1 ], [ P5272(true,28), P1009(true,7) : 1,1 ], [ P5314(true,41), P4673(true,11) : 1,1 ], [ P5391(true,24), P6499(true,11) : 1,1 ], [ P5424(true,20), P6499(true,11) : 1,1 ], [ P5440(true,19), P6499(true,11) : 1,1 ], [ P5449(true,12), P6499(true,11) : 1,1 ], [ P5481(true,31), P6499(true,11) : 1,1 ], [ P5506(true,23), P1009(true,7) : 1,1 ], [ P5517(true,18), P6499(true,11) : 1,1 ], [ P5536(true,22), P6499(true,11) : 1,1 ], [ P5633(true,13), P4673(true,11) : 1,1 ], [ P5686(true,18), P6499(true,11) : 1,1 ], [ P5773(true,23), P1009(true,7) : 1,1 ], [ P5798(true,32), P6499(true,11) : 1,1 ], [ P5825(true,26), P6499(true,11) : 1,1 ], [ P5870(true,23), P6499(true,11) : 1,1 ], [ P5910(true,15), P1009(true,7) : 1,1 ], [ P5946(true,13), P1149(true,12) : 1,1 ], [ P6012(true,15), P6499(true,11) : 1,1 ], [ P6033(true,16), P1009(true,7) : 1,1 ], [ P6061(true,35), P1009(true,7) : 1,1 ], [ P6069(true,15), P6499(true,11) : 1,1 ], [ P6106(true,23), P4673(true,11) : 1,1 ], [ P6132(true,19), P1009(true,7) : 1,1 ], [ P6158(true,21), P6499(true,11) : 1,1 ], [ P6190(true,22), P1585(true,14) : 1,1 ], [ P6236(true,18), P6499(true,11) : 1,1 ], [ P6256(true,16), P6499(true,11) : 1,1 ], [ P6379(true,14), P4673(true,11) : 1,1 ], [ P6398(true,15), P6499(true,11) : 1,1 ], [ P6407(true,7), P6499(true,11) : 1,1 ], [ P6415(true,9), P1955(true,16) : 1,1 ], [ P6415(true,9), P1955(true,16) : 1,1 ], [ P6417(true,11), P6499(true,11) : 1,1 ], [ P6429(true,11), P1955(true,16) : 1,1 ], [ P6431(true,13), P6499(true,11) : 1,1 ], [ P6442(true,14), P7297(true,12) : 1,1 ], [ P6455(true,27), P1009(true,7) : 1,1 ], [ P6460(true,12), P6499(true,11) : 1,1 ], [ P6492(true,21), P1009(true,7) : 1,1 ], [ P6497(true,12), P1149(true,12) : 1,1 ], [ P6517(true,11), P6499(true,11) : 1,1 ], [ P6543(true,15), P6499(true,11) : 1,1 ], [ P6589(true,35), P1009(true,7) : 1,1 ], [ P6599(true,17), P6499(true,11) : 1,1 ], [ P6613(true,11), P6499(true,11) : 1,1 ], [ P6620(true,12), P6499(true,11) : 1,1 ], [ P6633(true,12), P6499(true,11) : 1,1 ], [ P6633(true,12), P6499(true,11) : 1,1 ], [ P6666(true,36), P6499(true,11) : 1,1 ], [ P6682(true,13), P6499(true,11) : 1,1 ], [ P6703(true,26), P6499(true,11) : 1,1 ], [ P6755(true,23), P6499(true,11) : 1,1 ], [ P6768(true,16), P6499(true,11) : 1,1 ], [ P6789(true,21), P1009(true,7) : 1,1 ], [ P6807(true,25), P6499(true,11) : 1,1 ], [ P6841(true,27), P6499(true,11) : 1,1 ], [ P6862(true,16), P6499(true,11) : 1,1 ], [ P6911(true,29), P1009(true,7) : 1,1 ], [ P6948(true,15), P1009(true,7) : 1,1 ], [ P6968(true,27), P1009(true,7) : 1,1 ], [ P7028(true,32), P6499(true,11) : 1,1 ], [ P7047(true,16), P6499(true,11) : 1,1 ], [ P7064(true,13), P8459(true,12) : 1,1 ], [ P7072(true,21), P1009(true,7) : 1,1 ], [ P7109(true,26), P6499(true,11) : 1,1 ], [ P7130(true,13), P4673(true,11) : 1,1 ], [ P7165(true,34), P1009(true,7) : 1,1 ], [ P7171(true,13), P6499(true,11) : 1,1 ], [ P7185(true,15), P1009(true,7) : 1,1 ], [ P7213(true,25), P6499(true,11) : 1,1 ], [ P7263(true,32), P6499(true,11) : 1,1 ], [ P7299(true,14), P6499(true,11) : 1,1 ], [ P7339(true,28), P1009(true,7) : 1,1 ], [ P7356(true,24), P6499(true,11) : 1,1 ], [ P7379(true,22), P4673(true,11) : 1,1 ], [ P7411(true,15), P4673(true,11) : 1,1 ], [ P7438(true,20), P6499(true,11) : 1,1 ], [ P7480(true,13), P1149(true,12) : 1,1 ], [ P7480(true,13), P1149(true,12) : 1,1 ], [ P7514(true,29), P1009(true,7) : 1,1 ], [ P7523(true,16), P6499(true,11) : 1,1 ], [ P7523(true,16), P6499(true,11) : 1,1 ], [ P7546(true,12), P4673(true,11) : 1,1 ], [ P7546(true,12), P4673(true,11) : 1,1 ], [ P7559(true,16), P1009(true,7) : 1,1 ], [ P7594(true,21), P1009(true,7) : 1,1 ], [ P7605(true,18), P6499(true,11) : 1,1 ], [ P7667(true,16), P1009(true,7) : 1,1 ], [ P7693(true,33), P6499(true,11) : 1,1 ], [ P7708(true,15), P1009(true,7) : 1,1 ], [ P7724(true,19), P6499(true,11) : 1,1 ], [ P7738(true,14), P6499(true,11) : 1,1 ], [ P7750(true,12), P6499(true,11) : 1,1 ], [ P7787(true,16), P6499(true,11) : 1,1 ], [ P7825(true,35), P1009(true,7) : 1,1 ], [ P7867(true,12), P4673(true,11) : 1,1 ], [ P7897(true,33), P6499(true,11) : 1,1 ], [ P7928(true,23), P6499(true,11) : 1,1 ], [ P7947(true,19), P6499(true,11) : 1,1 ], [ P8000(true,29), P1009(true,7) : 1,1 ], [ P8036(true,16), P1009(true,7) : 1,1 ], [ P8046(true,17), P6499(true,11) : 1,1 ], [ P8121(true,17), P6499(true,11) : 1,1 ], [ P8155(true,21), P1585(true,14) : 1,1 ], [ P8197(true,14), P6499(true,11) : 1,1 ], [ P8213(true,13), P6499(true,11) : 1,1 ], [ P8231(true,11), P1009(true,7) : 1,1 ], [ P8248(true,19), P6499(true,11) : 1,1 ], [ P8279(true,12), P6499(true,11) : 1,1 ], [ P8287(true,13), P1009(true,7) : 1,1 ], [ P8297(true,11), P6499(true,11) : 1,1 ], [ P8388(true,57), P6499(true,11) : 1,1 ], [ P8440(true,21), P1009(true,7) : 1,1 ], [ P8469(true,22), P1009(true,7) : 1,1 ], [ P8483(true,14), P1009(true,7) : 1,1 ], [ P8497(true,13), P6499(true,11) : 1,1 ], [ P8536(true,42), P1009(true,7) : 1,1 ], [ P8541(true,12), P4673(true,11) : 1,1 ], [ P8611(true,16), P6499(true,11) : 1,1 ], [ P8619(true,13), P6499(true,11) : 1,1 ], [ P8685(true,20), P6499(true,11) : 1,1 ], [ P8721(true,30), P6499(true,11) : 1,1 ], [ P8755(true,26), P6499(true,11) : 1,1 ], [ P8781(true,19), P1436(true,12) : 1,1 ], [ P8804(true,19), P6499(true,11) : 1,1 ], [ P8820(true,13), P6499(true,11) : 1,1 ], [ P8882(true,29), P1009(true,7) : 1,1 ], [ P8924(true,23), P6499(true,11) : 1,1 ], [ P8936(true,13), P6499(true,11) : 1,1 ], [ P8957(true,14), P6499(true,11) : 1,1 ], [ P8988(true,18), P1009(true,7) : 1,1 ], [ P9028(true,21), P6499(true,11) : 1,1 ], [ P9060(true,35), P1009(true,7) : 1,1 ], [ P9100(true,25), P6499(true,11) : 1,1 ], [ P9129(true,28), P6499(true,11) : 1,1 ], [ P9175(true,20), P6499(true,11) : 1,1 ], [ P9196(true,24), P6499(true,11) : 1,1 ], [ P9219(true,26), P6499(true,11) : 1,1 ], [ P9296(true,64), P6499(true,11) : 1,1 ], [ P9360(true,23), P4673(true,11) : 1,1 ], [ P9391(true,13), P6499(true,11) : 1,1 ], [ P9426(true,38), P1009(true,7) : 1,1 ], [ P9435(true,16), P1009(true,7) : 1,1 ], [ P9452(true,24), P1009(true,7) : 1,1 ], [ P9468(true,23), P6499(true,11) : 1,1 ], [ P9488(true,21), P1009(true,7) : 1,1 ], [ P9497(true,16), P6499(true,11) : 1,1 ], [ P9527(true,17), P6499(true,11) : 1,1 ], [ P9580(true,26), P6499(true,11) : 1,1 ], [ P9596(true,19), P1009(true,7) : 1,1 ], [ P9669(true,19), P6499(true,11) : 1,1 ], [ P9702(true,32), P4673(true,11) : 1,1 ], [ P9736(true,31), P1009(true,7) : 1,1 ], [ P9765(true,16), P1009(true,7) : 1,1 ], [ P9784(true,26), P6499(true,11) : 1,1 ], [ P9853(true,34), P6499(true,11) : 1,1 ], [ P9876(true,22), P6499(true,11) : 1,1 ], [ P9911(true,13), P4673(true,11) : 1,1 ], [ P9944(true,16), P1009(true,7) : 1,1 ], [ P9966(true,22), P6499(true,11) : 1,1 ], [ P9982(true,13), P3160(true,12) : 1,1 ], [ P9988(true,19), P6499(true,11) : 1,1 ], [ P1313(true,14), P3160(true,12) : 2,2 ], [ P2320(true,12), P4673(true,11) : 2,2 ], [ P3161(true,13), P7297(true,12) : 2,2 ], [ P3361(true,14), P4673(true,11) : 2,2 ], [ P4805(true,11), P4673(true,11) : 2,2 ], [ P6428(true,10), P1954(true,15) : 2,2 ], [ P6569(true,15), P6568(true,14) : 2,2 ], [ P7298(true,13), P3189(true,11) : 2,2 ], [ P1065(true,13), P6499(true,11) : 3,3 ], [ P5433(true,12), P4673(true,11) : 3,3 ], [ P6415(true,9), P1010(true,8) : 3,3 ], [ P6415(true,9), P1010(true,8) : 3,3 ], [ P6595(true,13), P6632(true,11) : 3,3 ], [ P7918(true,13), P6440(true,12) : 3,3 ], [ P1073(true,13), P3189(true,11) : 4,4 ], [ P2854(true,13), P6440(true,12) : 4,4 ], [ P4998(true,15), P4673(true,11) : 4,4 ], [ P6415(true,9), P1311(true,12) : 4,4 ], [ P6415(true,9), P1311(true,12) : 4,4 ], [ P7599(true,12), P4673(true,11) : 4,4 ], [ P8241(true,12), P6440(true,12) : 4,4 ], [ P8416(true,12), P4673(true,11) : 4,4 ], [ P4995(true,12), P8240(true,11) : 5,5 ], [ P8415(true,11), P3189(true,11) : 5,5 ], [ P8607(true,12), P1149(true,12) : 6,6 ], [ P2496(true,13), P1149(true,12) : 7,7 ], [ P8259(true,11), P4673(true,11) : 7,7 ], [ P1901(true,14), P1017(true,9) : 8,8 ], [ P6029(true,12), P8240(true,11) : 10,10 ], [ P1153(true,13), P1152(true,12) : 12,12 ], [ P2945(true,13), P1063(true,11) : 12,12 ], [ P3590(true,12), P3189(true,11) : 12,12 ], [ P5380(true,13), P1017(true,9) : 12,12 ], [ P2616(true,12), P1063(true,11) : 13,13 ], [ P6429(true,11), P1010(true,8) : 15,15 ], [ P7984(true,13), P1017(true,9) : 16,16 ], [ P8258(true,10), P1585(true,14) : 30,30 ]]", 
		//		stack.toString());
		
		// After a change to favour RED states compared to any others in the selection of representative vertices in AMEquivalenceClass, the outcome is the following:
		Assert.assertEquals("[[ P1584(true,13), P1436(true,12) : 0,0 ], [ P2539(true,28), P4673(true,11) : 0,0 ], [ P2593(true,30), P4673(true,11) : 0,0 ], [ P2987(true,14), P1312(true,13) : 0,0 ], [ P3147(true,15), P1010(true,8) : 0,0 ], [ P3147(true,15), P4673(true,11) : 0,0 ], [ P3161(true,13), P6441(true,13) : 0,0 ], [ P3346(true,13), P4673(true,11) : 0,0 ], [ P4297(true,12), P4673(true,11) : 0,0 ], [ P4406(true,18), P4673(true,11) : 0,0 ], [ P4656(true,13), P4673(true,11) : 0,0 ], [ P4656(true,13), P4673(true,11) : 0,0 ], [ P6459(true,11), P1149(true,12) : 0,0 ], [ P7918(true,13), P1954(true,15) : 0,0 ], [ P8460(true,13), P3160(true,12) : 0,0 ], [ P8580(true,19), P4673(true,11) : 0,0 ], [ P9982(true,13), P7520(true,13) : 0,0 ], [ P1005(true,5), P6499(true,11) : 1,1 ], [ P1007(true,7), P6499(true,11) : 1,1 ], [ P1007(true,7), P6499(true,11) : 1,1 ], [ P1011(true,9), P6499(true,11) : 1,1 ], [ P1011(true,9), P6499(true,11) : 1,1 ], [ P1018(true,10), P1009(true,7) : 1,1 ], [ P1018(true,10), P1009(true,7) : 1,1 ], [ P1036(true,25), P6499(true,11) : 1,1 ], [ P1053(true,20), P1009(true,7) : 1,1 ], [ P1059(true,13), P1009(true,7) : 1,1 ], [ P1067(true,15), P1009(true,7) : 1,1 ], [ P1087(true,27), P1009(true,7) : 1,1 ], [ P1113(true,11), P6499(true,11) : 1,1 ], [ P1136(true,18), P1009(true,7) : 1,1 ], [ P1180(true,40), P1009(true,7) : 1,1 ], [ P1196(true,23), P6499(true,11) : 1,1 ], [ P1227(true,22), P6499(true,11) : 1,1 ], [ P1243(true,12), P4673(true,11) : 1,1 ], [ P1274(true,43), P1009(true,7) : 1,1 ], [ P1296(true,13), P6499(true,11) : 1,1 ], [ P1336(true,37), P6499(true,11) : 1,1 ], [ P1346(true,13), P6499(true,11) : 1,1 ], [ P1362(true,21), P4673(true,11) : 1,1 ], [ P1389(true,18), P6499(true,11) : 1,1 ], [ P1419(true,30), P6499(true,11) : 1,1 ], [ P1459(true,23), P1149(true,12) : 1,1 ], [ P1488(true,21), P1009(true,7) : 1,1 ], [ P1546(true,44), P1009(true,7) : 1,1 ], [ P1574(true,16), P6499(true,11) : 1,1 ], [ P1597(true,15), P6499(true,11) : 1,1 ], [ P1654(true,32), P6499(true,11) : 1,1 ], [ P1680(true,23), P1436(true,12) : 1,1 ], [ P1714(true,16), P1009(true,7) : 1,1 ], [ P1743(true,36), P6499(true,11) : 1,1 ], [ P1759(true,15), P6499(true,11) : 1,1 ], [ P1824(true,22), P1585(true,14) : 1,1 ], [ P1878(true,22), P1009(true,7) : 1,1 ], [ P1906(true,19), P1009(true,7) : 1,1 ], [ P1942(true,22), P6499(true,11) : 1,1 ], [ P1985(true,20), P4673(true,11) : 1,1 ], [ P2002(true,14), P6499(true,11) : 1,1 ], [ P2042(true,26), P6499(true,11) : 1,1 ], [ P2069(true,26), P6499(true,11) : 1,1 ], [ P2118(true,22), P1009(true,7) : 1,1 ], [ P2126(true,15), P6499(true,11) : 1,1 ], [ P2149(true,15), P6499(true,11) : 1,1 ], [ P2185(true,16), P6499(true,11) : 1,1 ], [ P2222(true,18), P1009(true,7) : 1,1 ], [ P2236(true,15), P6499(true,11) : 1,1 ], [ P2273(true,23), P1009(true,7) : 1,1 ], [ P2283(true,17), P1009(true,7) : 1,1 ], [ P2292(true,16), P6499(true,11) : 1,1 ], [ P2311(true,22), P6499(true,11) : 1,1 ], [ P2393(true,28), P1009(true,7) : 1,1 ], [ P2418(true,32), P1009(true,7) : 1,1 ], [ P2443(true,32), P1009(true,7) : 1,1 ], [ P2448(true,12), P6499(true,11) : 1,1 ], [ P2505(true,22), P6499(true,11) : 1,1 ], [ P2622(true,18), P1009(true,7) : 1,1 ], [ P2660(true,26), P6499(true,11) : 1,1 ], [ P2678(true,21), P1009(true,7) : 1,1 ], [ P2760(true,34), P6499(true,11) : 1,1 ], [ P2794(true,33), P1009(true,7) : 1,1 ], [ P2811(true,11), P6499(true,11) : 1,1 ], [ P2848(true,21), P1009(true,7) : 1,1 ], [ P2863(true,22), P1009(true,7) : 1,1 ], [ P2870(true,14), P4673(true,11) : 1,1 ], [ P2919(true,33), P6499(true,11) : 1,1 ], [ P2954(true,22), P6499(true,11) : 1,1 ], [ P3009(true,36), P6499(true,11) : 1,1 ], [ P3064(true,28), P1009(true,7) : 1,1 ], [ P3075(true,12), P6499(true,11) : 1,1 ], [ P3121(true,15), P1009(true,7) : 1,1 ], [ P3127(true,13), P6499(true,11) : 1,1 ], [ P3155(true,23), P1009(true,7) : 1,1 ], [ P3181(true,33), P6499(true,11) : 1,1 ], [ P3190(true,12), P6499(true,11) : 1,1 ], [ P3190(true,12), P6499(true,11) : 1,1 ], [ P3213(true,24), P1009(true,7) : 1,1 ], [ P3217(true,11), P6499(true,11) : 1,1 ], [ P3228(true,16), P6499(true,11) : 1,1 ], [ P3253(true,11), P6499(true,11) : 1,1 ], [ P3281(true,29), P6499(true,11) : 1,1 ], [ P3294(true,13), P6499(true,11) : 1,1 ], [ P3336(true,21), P6499(true,11) : 1,1 ], [ P3360(true,13), P1585(true,14) : 1,1 ], [ P3360(true,13), P6441(true,13) : 1,1 ], [ P3396(true,14), P6499(true,11) : 1,1 ], [ P3513(true,15), P4673(true,11) : 1,1 ], [ P3600(true,22), P1009(true,7) : 1,1 ], [ P3615(true,22), P6499(true,11) : 1,1 ], [ P3627(true,15), P6499(true,11) : 1,1 ], [ P3660(true,21), P1009(true,7) : 1,1 ], [ P3702(true,26), P6499(true,11) : 1,1 ], [ P3785(true,42), P6499(true,11) : 1,1 ], [ P3805(true,23), P6499(true,11) : 1,1 ], [ P3849(true,29), P6499(true,11) : 1,1 ], [ P3897(true,18), P6499(true,11) : 1,1 ], [ P3954(true,23), P6499(true,11) : 1,1 ], [ P4072(true,18), P6499(true,11) : 1,1 ], [ P4101(true,24), P1009(true,7) : 1,1 ], [ P4113(true,19), P1009(true,7) : 1,1 ], [ P4133(true,16), P1009(true,7) : 1,1 ], [ P4203(true,16), P6499(true,11) : 1,1 ], [ P4235(true,29), P6499(true,11) : 1,1 ], [ P4253(true,18), P6499(true,11) : 1,1 ], [ P4269(true,15), P6499(true,11) : 1,1 ], [ P4328(true,19), P1009(true,7) : 1,1 ], [ P4351(true,13), P6499(true,11) : 1,1 ], [ P4395(true,18), P1009(true,7) : 1,1 ], [ P4449(true,18), P6499(true,11) : 1,1 ], [ P4500(true,30), P6499(true,11) : 1,1 ], [ P4548(true,43), P6499(true,11) : 1,1 ], [ P4596(true,18), P6499(true,11) : 1,1 ], [ P4640(true,40), P6499(true,11) : 1,1 ], [ P4667(true,10), P6499(true,11) : 1,1 ], [ P4694(true,14), P6499(true,11) : 1,1 ], [ P4706(true,15), P1009(true,7) : 1,1 ], [ P4711(true,12), P6499(true,11) : 1,1 ], [ P4732(true,20), P6499(true,11) : 1,1 ], [ P4749(true,12), P6499(true,11) : 1,1 ], [ P4773(true,15), P4673(true,11) : 1,1 ], [ P4801(true,31), P1009(true,7) : 1,1 ], [ P4828(true,34), P6499(true,11) : 1,1 ], [ P4844(true,17), P6499(true,11) : 1,1 ], [ P4856(true,13), P6499(true,11) : 1,1 ], [ P4884(true,23), P6499(true,11) : 1,1 ], [ P4958(true,19), P6499(true,11) : 1,1 ], [ P4982(true,13), P6499(true,11) : 1,1 ], [ P5016(true,33), P4673(true,11) : 1,1 ], [ P5071(true,16), P6499(true,11) : 1,1 ], [ P5084(true,16), P1009(true,7) : 1,1 ], [ P5143(true,17), P4673(true,11) : 1,1 ], [ P5162(true,13), P6499(true,11) : 1,1 ], [ P5188(true,31), P1009(true,7) : 1,1 ], [ P5272(true,28), P1009(true,7) : 1,1 ], [ P5314(true,41), P4673(true,11) : 1,1 ], [ P5391(true,24), P6499(true,11) : 1,1 ], [ P5424(true,20), P6499(true,11) : 1,1 ], [ P5440(true,19), P6499(true,11) : 1,1 ], [ P5449(true,12), P6499(true,11) : 1,1 ], [ P5481(true,31), P6499(true,11) : 1,1 ], [ P5506(true,23), P1009(true,7) : 1,1 ], [ P5517(true,18), P6499(true,11) : 1,1 ], [ P5536(true,22), P6499(true,11) : 1,1 ], [ P5633(true,13), P4673(true,11) : 1,1 ], [ P5686(true,18), P6499(true,11) : 1,1 ], [ P5773(true,23), P1009(true,7) : 1,1 ], [ P5798(true,32), P6499(true,11) : 1,1 ], [ P5825(true,26), P6499(true,11) : 1,1 ], [ P5870(true,23), P6499(true,11) : 1,1 ], [ P5910(true,15), P1009(true,7) : 1,1 ], [ P5946(true,13), P1149(true,12) : 1,1 ], [ P6012(true,15), P6499(true,11) : 1,1 ], [ P6033(true,16), P1009(true,7) : 1,1 ], [ P6061(true,35), P1009(true,7) : 1,1 ], [ P6069(true,15), P6499(true,11) : 1,1 ], [ P6106(true,23), P4673(true,11) : 1,1 ], [ P6132(true,19), P1009(true,7) : 1,1 ], [ P6158(true,21), P6499(true,11) : 1,1 ], [ P6190(true,22), P1585(true,14) : 1,1 ], [ P6236(true,18), P6499(true,11) : 1,1 ], [ P6256(true,16), P6499(true,11) : 1,1 ], [ P6379(true,14), P4673(true,11) : 1,1 ], [ P6398(true,15), P6499(true,11) : 1,1 ], [ P6407(true,7), P6499(true,11) : 1,1 ], [ P6415(true,9), P1955(true,16) : 1,1 ], [ P6415(true,9), P1955(true,16) : 1,1 ], [ P6417(true,11), P6499(true,11) : 1,1 ], [ P6429(true,11), P1955(true,16) : 1,1 ], [ P6431(true,13), P6499(true,11) : 1,1 ], [ P6442(true,14), P7297(true,12) : 1,1 ], [ P6455(true,27), P1009(true,7) : 1,1 ], [ P6460(true,12), P6499(true,11) : 1,1 ], [ P6492(true,21), P1009(true,7) : 1,1 ], [ P6497(true,12), P1149(true,12) : 1,1 ], [ P6517(true,11), P6499(true,11) : 1,1 ], [ P6543(true,15), P6499(true,11) : 1,1 ], [ P6589(true,35), P1009(true,7) : 1,1 ], [ P6599(true,17), P6499(true,11) : 1,1 ], [ P6613(true,11), P6499(true,11) : 1,1 ], [ P6620(true,12), P6499(true,11) : 1,1 ], [ P6633(true,12), P6499(true,11) : 1,1 ], [ P6633(true,12), P6499(true,11) : 1,1 ], [ P6666(true,36), P6499(true,11) : 1,1 ], [ P6682(true,13), P6499(true,11) : 1,1 ], [ P6703(true,26), P6499(true,11) : 1,1 ], [ P6755(true,23), P6499(true,11) : 1,1 ], [ P6768(true,16), P6499(true,11) : 1,1 ], [ P6789(true,21), P1009(true,7) : 1,1 ], [ P6807(true,25), P6499(true,11) : 1,1 ], [ P6841(true,27), P6499(true,11) : 1,1 ], [ P6862(true,16), P6499(true,11) : 1,1 ], [ P6911(true,29), P1009(true,7) : 1,1 ], [ P6948(true,15), P1009(true,7) : 1,1 ], [ P6968(true,27), P1009(true,7) : 1,1 ], [ P7028(true,32), P6499(true,11) : 1,1 ], [ P7047(true,16), P6499(true,11) : 1,1 ], [ P7064(true,13), P8459(true,12) : 1,1 ], [ P7072(true,21), P1009(true,7) : 1,1 ], [ P7109(true,26), P6499(true,11) : 1,1 ], [ P7130(true,13), P4673(true,11) : 1,1 ], [ P7165(true,34), P1009(true,7) : 1,1 ], [ P7171(true,13), P6499(true,11) : 1,1 ], [ P7185(true,15), P1009(true,7) : 1,1 ], [ P7213(true,25), P6499(true,11) : 1,1 ], [ P7263(true,32), P6499(true,11) : 1,1 ], [ P7299(true,14), P6499(true,11) : 1,1 ], [ P7339(true,28), P1009(true,7) : 1,1 ], [ P7356(true,24), P6499(true,11) : 1,1 ], [ P7379(true,22), P4673(true,11) : 1,1 ], [ P7411(true,15), P4673(true,11) : 1,1 ], [ P7438(true,20), P6499(true,11) : 1,1 ], [ P7480(true,13), P1149(true,12) : 1,1 ], [ P7480(true,13), P1149(true,12) : 1,1 ], [ P7514(true,29), P1009(true,7) : 1,1 ], [ P7523(true,16), P6499(true,11) : 1,1 ], [ P7523(true,16), P6499(true,11) : 1,1 ], [ P7546(true,12), P4673(true,11) : 1,1 ], [ P7546(true,12), P4673(true,11) : 1,1 ], [ P7559(true,16), P1009(true,7) : 1,1 ], [ P7594(true,21), P1009(true,7) : 1,1 ], [ P7605(true,18), P6499(true,11) : 1,1 ], [ P7667(true,16), P1009(true,7) : 1,1 ], [ P7693(true,33), P6499(true,11) : 1,1 ], [ P7708(true,15), P1009(true,7) : 1,1 ], [ P7724(true,19), P6499(true,11) : 1,1 ], [ P7738(true,14), P6499(true,11) : 1,1 ], [ P7750(true,12), P6499(true,11) : 1,1 ], [ P7787(true,16), P6499(true,11) : 1,1 ], [ P7825(true,35), P1009(true,7) : 1,1 ], [ P7867(true,12), P4673(true,11) : 1,1 ], [ P7897(true,33), P6499(true,11) : 1,1 ], [ P7928(true,23), P6499(true,11) : 1,1 ], [ P7947(true,19), P6499(true,11) : 1,1 ], [ P8000(true,29), P1009(true,7) : 1,1 ], [ P8036(true,16), P1009(true,7) : 1,1 ], [ P8046(true,17), P6499(true,11) : 1,1 ], [ P8121(true,17), P6499(true,11) : 1,1 ], [ P8155(true,21), P1585(true,14) : 1,1 ], [ P8197(true,14), P6499(true,11) : 1,1 ], [ P8213(true,13), P6499(true,11) : 1,1 ], [ P8231(true,11), P1009(true,7) : 1,1 ], [ P8248(true,19), P6499(true,11) : 1,1 ], [ P8279(true,12), P6499(true,11) : 1,1 ], [ P8287(true,13), P1009(true,7) : 1,1 ], [ P8297(true,11), P6499(true,11) : 1,1 ], [ P8388(true,57), P6499(true,11) : 1,1 ], [ P8440(true,21), P1009(true,7) : 1,1 ], [ P8469(true,22), P1009(true,7) : 1,1 ], [ P8483(true,14), P1009(true,7) : 1,1 ], [ P8497(true,13), P6499(true,11) : 1,1 ], [ P8536(true,42), P1009(true,7) : 1,1 ], [ P8541(true,12), P4673(true,11) : 1,1 ], [ P8611(true,16), P6499(true,11) : 1,1 ], [ P8619(true,13), P6499(true,11) : 1,1 ], [ P8685(true,20), P6499(true,11) : 1,1 ], [ P8721(true,30), P6499(true,11) : 1,1 ], [ P8755(true,26), P6499(true,11) : 1,1 ], [ P8781(true,19), P1436(true,12) : 1,1 ], [ P8804(true,19), P6499(true,11) : 1,1 ], [ P8820(true,13), P6499(true,11) : 1,1 ], [ P8882(true,29), P1009(true,7) : 1,1 ], [ P8924(true,23), P6499(true,11) : 1,1 ], [ P8936(true,13), P6499(true,11) : 1,1 ], [ P8957(true,14), P6499(true,11) : 1,1 ], [ P8988(true,18), P1009(true,7) : 1,1 ], [ P9028(true,21), P6499(true,11) : 1,1 ], [ P9060(true,35), P1009(true,7) : 1,1 ], [ P9100(true,25), P6499(true,11) : 1,1 ], [ P9129(true,28), P6499(true,11) : 1,1 ], [ P9175(true,20), P6499(true,11) : 1,1 ], [ P9196(true,24), P6499(true,11) : 1,1 ], [ P9219(true,26), P6499(true,11) : 1,1 ], [ P9296(true,64), P6499(true,11) : 1,1 ], [ P9360(true,23), P4673(true,11) : 1,1 ], [ P9391(true,13), P6499(true,11) : 1,1 ], [ P9426(true,38), P1009(true,7) : 1,1 ], [ P9435(true,16), P1009(true,7) : 1,1 ], [ P9452(true,24), P1009(true,7) : 1,1 ], [ P9468(true,23), P6499(true,11) : 1,1 ], [ P9488(true,21), P1009(true,7) : 1,1 ], [ P9497(true,16), P6499(true,11) : 1,1 ], [ P9527(true,17), P6499(true,11) : 1,1 ], [ P9580(true,26), P6499(true,11) : 1,1 ], [ P9596(true,19), P1009(true,7) : 1,1 ], [ P9669(true,19), P6499(true,11) : 1,1 ], [ P9702(true,32), P4673(true,11) : 1,1 ], [ P9736(true,31), P1009(true,7) : 1,1 ], [ P9765(true,16), P1009(true,7) : 1,1 ], [ P9784(true,26), P6499(true,11) : 1,1 ], [ P9853(true,34), P6499(true,11) : 1,1 ], [ P9876(true,22), P6499(true,11) : 1,1 ], [ P9911(true,13), P4673(true,11) : 1,1 ], [ P9944(true,16), P1009(true,7) : 1,1 ], [ P9966(true,22), P6499(true,11) : 1,1 ], [ P9982(true,13), P3160(true,12) : 1,1 ], [ P9988(true,19), P6499(true,11) : 1,1 ], [ P1313(true,14), P3160(true,12) : 2,2 ], [ P2320(true,12), P4673(true,11) : 2,2 ], [ P3161(true,13), P7297(true,12) : 2,2 ], [ P3361(true,14), P4673(true,11) : 2,2 ], [ P4805(true,11), P4673(true,11) : 2,2 ], [ P6428(true,10), P1954(true,15) : 2,2 ], [ P6569(true,15), P6568(true,14) : 2,2 ], [ P7298(true,13), P3189(true,11) : 2,2 ], [ P1065(true,13), P6499(true,11) : 3,3 ], [ P5433(true,12), P4673(true,11) : 3,3 ], [ P6415(true,9), P1010(true,8) : 3,3 ], [ P6415(true,9), P1010(true,8) : 3,3 ], [ P6595(true,13), P6632(true,11) : 3,3 ], [ P7918(true,13), P6440(true,12) : 3,3 ], [ P1073(true,13), P3189(true,11) : 4,4 ], [ P2854(true,13), P6440(true,12) : 4,4 ], [ P4998(true,15), P4673(true,11) : 4,4 ], [ P6415(true,9), P1311(true,12) : 4,4 ], [ P6415(true,9), P1311(true,12) : 4,4 ], [ P7599(true,12), P4673(true,11) : 4,4 ], [ P8241(true,12), P6440(true,12) : 4,4 ], [ P8416(true,12), P4673(true,11) : 4,4 ], [ P4995(true,12), P8240(true,11) : 5,5 ], [ P8415(true,11), P3189(true,11) : 5,5 ], [ P8607(true,12), P1149(true,12) : 6,6 ], [ P2496(true,13), P1149(true,12) : 7,7 ], [ P8259(true,11), P4673(true,11) : 7,7 ], [ P1901(true,14), P3324(true,9) : 8,8 ], [ P6029(true,12), P8240(true,11) : 10,10 ], [ P1153(true,13), P1152(true,12) : 12,12 ], [ P2945(true,13), P1063(true,11) : 12,12 ], [ P3590(true,12), P3189(true,11) : 12,12 ], [ P5380(true,13), P3324(true,9) : 12,12 ], [ P2616(true,12), P1063(true,11) : 13,13 ], [ P6429(true,11), P1010(true,8) : 15,15 ], [ P7984(true,13), P3324(true,9) : 16,16 ], [ P8258(true,10), P1585(true,14) : 30,30 ]]",stack.toString());
	}

}
